drc1<-filter(drc1, INC %in% c("L"))
b<-drm(germ_perc~DAY,factor(chillweeks):factor(Taxa), data=drc1,fct = LL.3(fixed = c(NA, .8, NA), names = c("b", "gmax", "e50")), type ="continuous")
b<-drm(germ_perc~DAY,factor(chillweeks):factor(Taxa), data=drc1,fct = LL.3(fixed = c(NA, .75, NA), names = c("b", "gmax", "e50")), type ="continuous")
bb<-as.data.frame(coef(b))
goo<-summary(b)
goo<-as.data.frame(goo[[3]])
goo<-rownames_to_column(goo,"descriptor")
#?separate()
goo<-separate(goo,col = descriptor,sep=":",c("param","chill_weeks","Taxa"))
goo$chill_weeks<-as.numeric(goo$chill_weeks)
goo2<-filter(goo,param=="gmax")
goo3<-filter(goo,param=="e50")
ggplot(goo3,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa))+geom_smooth(method="lm",aes(color=Taxa))
b<-drm(germ_perc~DAY,factor(chillweeks):factor(Taxa), data=drc1,fct = LL.3(fixed = c(NA, NA, NA), names = c("b", "gmax", "e50")), type ="continuous")
bb<-as.data.frame(coef(b))
goo<-summary(b)
goo<-as.data.frame(goo[[3]])
goo<-rownames_to_column(goo,"descriptor")
#?separate()
goo<-separate(goo,col = descriptor,sep=":",c("param","chill_weeks","Taxa"))
goo$chill_weeks<-as.numeric(goo$chill_weeks)
goo2<-filter(goo,param=="gmax")
goo3<-filter(goo,param=="e50")
?resp_mi()
ggplot(goo2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa))+geom_smooth(method="lm",aes(color=Taxa))
ggplot(goo3,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa))+geom_smooth(method="lm",aes(color=Taxa))
##mi model
colnames(goo3)[5]<-"se"
e50.mod<-brm(Estimate|se(se,sigma=TRUE)~chill_weeks*Taxa,data=goo3,control=list(adapt_delta=.99),warmup=3000,iter=4000)
newbers<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.01),chill_weeks=c(6,6,6,6,12,12,12,12))
ePred<-predict(e50.mod,newdata = newbers,probs = c(.25,.75,.05,.95))
plot<-cbind(newbers,ePred)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=2)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+ggthemes::theme_few()
newbers<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.01),chill_weeks=c(2,2,2,2,12,12,12,12))
ePred<-predict(e50.mod,newdata = newbers,probs = c(.25,.75,.05,.95))
plot<-cbind(newbers,ePred)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=2)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+ggthemes::theme_few()
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=2)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))+ggthemes::theme_few()
newbers<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.01),chill_weeks=c(4,4,4,4,12,12,12,12))
ePred<-predict(e50.mod,newdata = newbers,probs = c(.25,.75,.05,.95))
plot<-cbind(newbers,ePred)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=2)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))+ggthemes::theme_few()
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))+ggthemes::theme_few()
range(goo3$se)
View(goo3)
newbers<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.1),chill_weeks=c(4,4,4,4,12,12,12,12))
ePred<-predict(e50.mod,newdata = newbers,probs = c(.25,.75,.05,.95))
plot<-cbind(newbers,ePred)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))+ggthemes::theme_few()
drc1<-filter(drc1, chillweeks %in% c(5,6,7,8,9,11,13))
drc1<-filter(drc1, INC %in% c("L"))
drc1<-filter(drc1, INC %in% c("L"))
b<-drm(germ_perc~DAY,factor(chillweeks):factor(Taxa), data=drc1,fct = LL.3(fixed = c(NA, NA, NA), names = c("b", "gmax", "e50")), type ="continuous")
bb<-as.data.frame(coef(b))
goo<-summary(b)
goo<-as.data.frame(goo[[3]])
goo<-rownames_to_column(goo,"descriptor")
#?separate()
goo<-separate(goo,col = descriptor,sep=":",c("param","chill_weeks","Taxa"))
goo$chill_weeks<-as.numeric(goo$chill_weeks)
goo2<-filter(goo,param=="gmax")
goo3<-filter(goo,param=="e50")
?resp_mi()
ggplot(goo2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa))+geom_smooth(method="lm",aes(color=Taxa))
ggplot(goo3,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa))+geom_smooth(method="lm",aes(color=Taxa))
##mi model
colnames(goo3)[5]<-"se"
range(goo3$se)
####drc models Dec 17, 2018
##drc treats right centered data is if they will oneday gertminatrion, this is not biologically fair due to dormancy cycling
#but if I dont include these data, the model has no away of accounting for final germination percentage hmm
#also models with with left censoring struggle to converged, although I think its actually having trouble with models with treeatments that have all zero, +++actually its both
##current idea, could ignore left censor and let the model estimate the upper bound, thats probably accuraten for most species except Carex.
rm(list=ls())
options(stringsAsFactors = FALSE)
setwd("~/Documents/git/timetogerminate/germination_trials/input")
library(tidyverse)
library(lubridate)
library("Hmisc")
library(drc)
library(brms)
load("drcmods")
d<-read.csv("germ_data_forDRC.csv",header= TRUE)
d<-filter(d, !Taxa %in% c("Phlox cuspidata","Impatiens capensis", "Carex grisea"))
specieslist<-sort(unique(d$Taxa))
d$DAY<-ifelse(d$DAY==-Inf,NA,d$DAY)###I think this might remove all left censoring
#d$DAY<-ifelse(d$DAY==-Inf,0,d$DAY)# wont converge if left censoring is included
###remove infinity rows with no left of right censoring
nonstartcens<-filter(d,END==0 & germination==0)
noendcense<-filter(d,END==Inf & germination==0)
d<-anti_join(d, nonstartcens)
d<-anti_join(d,noendcense)
###model without right censoring
#d.nocen<-filter(d,END!=Inf)
#average ungerminated
#dormy<-dplyr::filter(d,END==Inf)
#mean(dormy$germination) #7.1 so on average germination percent was ~60
### make each species its own data framed
transit<-filter(d, DAY!=25)
transit<-transit %>% group_by(plate_num) %>% summarise(mean=mean(germination))
transit<-filter(transit,mean>0)
germed<-unique(transit$plate_num)
rm(list=ls())
options(stringsAsFactors = FALSE)
setwd("~/Documents/git/timetogerminate/germination_trials/input")
library(tidyverse)
library(lubridate)
library("Hmisc")
library(drc)
library(brms)
#load("drcmods")
d<-read.csv("germ_data_forDRC.csv",header= TRUE)
d<-filter(d, !Taxa %in% c("Phlox cuspidata","Impatiens capensis", "Carex grisea"))
specieslist<-sort(unique(d$Taxa))
d$DAY<-ifelse(d$DAY==-Inf,NA,d$DAY)###I think this might remove all left censoring
###remove infinity rows with no left of right censoring
nonstartcens<-filter(d,END==0 & germination==0)
noendcense<-filter(d,END==Inf & germination==0)
d<-anti_join(d, nonstartcens)
d<-anti_join(d,noendcense)
### make each species its own data framed
transit<-filter(d, DAY!=25)
transit<-transit %>% group_by(plate_num) %>% summarise(mean=mean(germination))
transit<-filter(transit,mean>0)
germed<-unique(transit$plate_num)
d<-d %>%filter(plate_num %in% c(germed))
View(d)
d<-filter(d,INC=="L")
realdat<-d
realdat$chill_time<-NA
realdat<- within(realdat, chill_time[COLD=="0" ]<-0)
realdat<- within(realdat, chill_time[COLD=="A" ]<-14)
realdat<- within(realdat, chill_time[COLD=="B" ]<-28)
realdat<- within(realdat, chill_time[COLD=="C" ]<-35)
realdat<- within(realdat, chill_time[COLD=="D" ]<-42)
realdat<- within(realdat, chill_time[COLD=="E" ]<-49)
realdat<- within(realdat, chill_time[COLD=="f" ]<-56)
realdat<- within(realdat, chill_time[COLD=="G" ]<-63)
realdat<- within(realdat, chill_time[COLD=="H" ]<-77)
realdat<- within(realdat, chill_time[COLD=="i" ]<-91)
realdat$chillweeks<-realdat$chill_time/7
drc1<-filter(realdat, Taxa %in% c("Polygonum virginiatum", "Anemone virginana","Cryptotaenia canadensis",
"Eurbia diviricata"))
mody<-function(x) {
the_fit <- drm(germination~DAY+END, data=x ,fct = LL.3(), type ="event",upperl=c(NA,1,NA))
setNames(data.frame(t(coef(the_fit))), c("b", "d","e"))
"predict"(the_fit)
}
m1<-drc1 %>% group_by(Taxa,COLD) %>%do(mody(.))
b<-drm(germ_perc~DAY,factor(chillweeks):factor(Taxa), data=drc1,fct = LL.3(fixed = c(NA, .8, NA), names = c("b", "gmax", "e50")), type ="continuous")
######## May 5 emprical plots for priorty effect project
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
if(length(grep("Lizzie", getwd())>0)) {
setwd("~/Documents/git/projects/misc/dan/timetogerminate/germination_trials")
} else setwd("~/Documents/git/timetogerminate/germination_trials")
library(ggplot2)
realdat<-read.csv("input/daily_dat_nointerval.csv")
realdat$chill_time<-NA
realdat<- within(realdat, chill_time[COLD=="0" ]<-0)
realdat<- within(realdat, chill_time[COLD=="A" ]<-14)
realdat<- within(realdat, chill_time[COLD=="B" ]<-28)
realdat<- within(realdat, chill_time[COLD=="C" ]<-35)
realdat<- within(realdat, chill_time[COLD=="D" ]<-42)
realdat<- within(realdat, chill_time[COLD=="E" ]<-49)
realdat<- within(realdat, chill_time[COLD=="f" ]<-56)
realdat<- within(realdat, chill_time[COLD=="G" ]<-63)
realdat<- within(realdat, chill_time[COLD=="H" ]<-77)
realdat<- within(realdat, chill_time[COLD=="i" ]<-91)
realdat$chillweeks<-realdat$chill_time/7 # make chilling weeks instead of days
realdat$force<-NA # make forcing numeric
realdat<- within(realdat, force[INC=="L"]<-0)
realdat<- within(realdat, force[INC=="H"]<-1)
realdat<- dplyr::filter(realdat,!Taxa %in% c("Phlox cuspidata","Impatiens capensis","Carex grisea", "Carex grayi"))
realdat$germ_perc<-NA
realdat$germ_perc<-realdat$germ_num/realdat$tot_seed
realdat$germ_perc<-ifelse(realdat$germ_perc>1,1,realdat$germ_perc)
range(realdat$germ_perc)
jitter <- position_jitter(width = 0.1, height = 0.01)
ggplot(realdat,aes(DAY,germ_perc))+
stat_summary(aes(group=chillweeks,color=chillweeks),position=jitter,size=0.1)+
#geom_smooth(aes(group=chillweeks,color=chillweeks),span=.85,size=.5,se=FALSE)+
facet_grid(INC~Taxa)+ggthemes::theme_few(base_size = 9)+ scale_color_distiller(,type = "seq",
direction = 1,
palette = "Greys")
unique(realdat$Taxa)
drc1<-filter(realdat, Taxa %in% c("Polygonum virginiatum", "Anemone virginana","Cryptotaenia canadensis",
"Eurbia diviricata"))
#drc2<-filter(realdat, !Taxa %in% c("Polygonum virginiatum", "Anemone virginana","Cryptotaenia canadensis",
#                                  "Eurbia diviricata","Thalictrum dioicum","Silene stellata" ))
unique(drc1$chillweeks)
drc1<-filter(drc1, chillweeks %in% c(5,6,7,8,9,11,13))
drc1<-filter(drc1, INC %in% c("L"))
drc2<-filter(drc2, chillweeks %in% c(5,7,9,11))
b<-drm(germ_perc~DAY,factor(chillweeks):factor(Taxa), data=drc1,fct = LL.3(fixed = c(NA, .8, NA), names = c("b", "gmax", "e50")), type ="continuous")
bb<-as.data.frame(coef(b))
goo<-summary(b)
goo<-as.data.frame(goo[[3]])
goo<-rownames_to_column(goo,"descriptor")
#?separate()
goo<-separate(goo,col = descriptor,sep=":",c("param","chill_weeks","Taxa"))
goo$chill_weeks<-as.numeric(goo$chill_weeks)
goo2<-filter(goo,param=="gmax")
goo3<-filter(goo,param=="e50")
?resp_mi()
ggplot(goo2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa))+geom_smooth(method="lm",aes(color=Taxa))
ggplot(goo3,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa))+geom_smooth(method="lm",aes(color=Taxa))
drc1<-filter(drc1, chillweeks %in% c(2,4,5,6,7,8,9,11,13))
drc1<-filter(realdat, Taxa %in% c("Polygonum virginiatum", "Anemone virginana","Cryptotaenia canadensis",
"Eurbia diviricata"))
unique(drc1$chillweeks)
drc1<-filter(drc1, chillweeks %in% c(2,4,5,6,7,8,9,11,13))
drc1<-filter(drc1, INC %in% c("L"))
b<-drm(germ_perc~DAY,factor(chillweeks):factor(Taxa), data=drc1,fct = LL.3(fixed = c(NA, .8, NA), names = c("b", "gmax", "e50")), type ="continuous")
drc1<-filter(drc1, chillweeks %in% c(4,5,6,7,8,9,11,13))
drc1<-filter(drc1, INC %in% c("L"))
drc2<-filter(drc2, chillweeks %in% c(5,7,9,11))
drc2<-filter(drc2, INC %in% c("L"))
b<-drm(germ_perc~DAY,factor(chillweeks):factor(Taxa), data=drc1,fct = LL.3(fixed = c(NA, .8, NA), names = c("b", "gmax", "e50")), type ="continuous")
drc1<-filter(drc1, INC %in% c("H"))
drc1<-filter(realdat, Taxa %in% c("Polygonum virginiatum", "Anemone virginana","Cryptotaenia canadensis",
"Eurbia diviricata"))
unique(drc1$chillweeks)
drc1<-filter(drc1, chillweeks %in% c(4,5,6,7,8,9,11,13))
drc1<-filter(drc1, INC %in% c("H"))
b<-drm(germ_perc~DAY,factor(chillweeks):factor(Taxa), data=drc1,fct = LL.3(fixed = c(NA, .8, NA), names = c("b", "gmax", "e50")), type ="continuous")
b<-drm(germ_perc~DAY,factor(chillweeks):factor(Taxa), data=drc1,fct = LL.3(fixed = c(NA, .9, NA), names = c("b", "gmax", "e50")), type ="continuous")
bb<-as.data.frame(coef(b))
goo<-summary(b)
goo<-as.data.frame(goo[[3]])
goo<-rownames_to_column(goo,"descriptor")
#?separate()
goo<-separate(goo,col = descriptor,sep=":",c("param","chill_weeks","Taxa"))
goo$chill_weeks<-as.numeric(goo$chill_weeks)
goo2<-filter(goo,param=="gmax")
goo3<-filter(goo,param=="e50")
?resp_mi()
ggplot(goo2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa))+geom_smooth(method="lm",aes(color=Taxa))
ggplot(goo3,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa))+geom_smooth(method="lm",aes(color=Taxa))
b<-drm(germ_perc~DAY,factor(chillweeks):factor(Taxa), data=drc1,fct = LL.3(fixed = c(NA,NA, NA), names = c("b", "gmax", "e50")), type ="continuous")
bb<-as.data.frame(coef(b))
bb<-as.data.frame(coef(b))
bb<-as.data.frame(coef(b))
bb<-as.data.frame(coef(b))
bb<-as.data.frame(coef(b))
bb<-as.data.frame(coef(b))
goo<-summary(b)
goo<-as.data.frame(goo[[3]])
goo<-rownames_to_column(goo,"descriptor")
#?separate()
goo<-separate(goo,col = descriptor,sep=":",c("param","chill_weeks","Taxa"))
goo$chill_weeks<-as.numeric(goo$chill_weeks)
goo2<-filter(goo,param=="gmax")
goo3<-filter(goo,param=="e50")
?resp_mi()
ggplot(goo2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa))+geom_smooth(method="lm",aes(color=Taxa))
ggplot(goo2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa))+geom_smooth(method="lm",aes(color=Taxa))
drc1<-filter(drc1, INC %in% c("L"))
drc2<-filter(drc2, chillweeks %in% c(5,7,9,11))
drc2<-filter(drc2, INC %in% c("L"))
b<-drm(germ_perc~DAY,factor(chillweeks):factor(Taxa), data=drc1,fct = LL.3(fixed = c(NA,NA, NA), names = c("b", "gmax", "e50")), type ="continuous")
drc1<-filter(realdat, Taxa %in% c("Polygonum virginiatum", "Anemone virginana","Cryptotaenia canadensis",
"Eurbia diviricata"))
unique(drc1$chillweeks)
drc1<-filter(drc1, chillweeks %in% c(4,5,6,7,8,9,11,13))
drc1<-filter(drc1, INC %in% c("L"))
drc2<-filter(drc2, chillweeks %in% c(5,7,9,11))
b<-drm(germ_perc~DAY,factor(chillweeks):factor(Taxa), data=drc1,fct = LL.3(fixed = c(NA,NA, NA), names = c("b", "gmax", "e50")), type ="continuous")
bb<-as.data.frame(coef(b))
goo<-summary(b)
goo<-as.data.frame(goo[[3]])
goo<-rownames_to_column(goo,"descriptor")
#?separate()
goo<-separate(goo,col = descriptor,sep=":",c("param","chill_weeks","Taxa"))
goo$chill_weeks<-as.numeric(goo$chill_weeks)
goo2<-filter(goo,param=="gmax")
goo3<-filter(goo,param=="e50")
?resp_mi()
ggplot(goo2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa))+geom_smooth(method="lm",aes(color=Taxa))
ggplot(goo3,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa))+geom_smooth(method="lm",aes(color=Taxa))
library(brms)
##mi model
colnames(goo3)[5]<-"se"
range(goo3$se)
median(goo3$se)
e50.mod<-brm(Estimate|se(se,sigma=TRUE)~chill_weeks*Taxa,data=goo3,control=list(adapt_delta=.99),warmup=3000,iter=4000)
newbers<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.37),chill_weeks=c(4,4,4,4,12,12,12,12))
ePred<-predict(e50.mod,newdata = newbers,probs = c(.25,.75,.05,.95))
plot<-cbind(newbers,ePred)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))+ggthemes::theme_few()
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))+
scale_y_continuous(breaks=c(0,4,8,12,16))+ggthemes::theme_few()
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))+
scale_y_continuous(breaks=c(2,4,8,12,16))+ggthemes::theme_few()
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))+
scale_y_continuous(breaks=c(2,4,6,8,10,12,16))+ggthemes::theme_few()
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))+
scale_y_continuous(breaks=c(2,4,6,8,10,12,,1516))+ggthemes::theme_few()
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))+
scale_y_continuous(breaks=c(2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()
gmax.mod<-brm(Estimate|se(se,sigma=TRUE)~chill_weeks*Taxa,data=goo2,control=list(adapt_delta=.99),warmup=3000,iter=4000)
colnames(goo2)[5]<-"se"
newbers<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.37),chill_weeks=c(4,4,4,4,12,12,12,12))
gmax.mod<-brm(Estimate|se(se,sigma=TRUE)~chill_weeks*Taxa,data=goo2,control=list(adapt_delta=.99),warmup=3000,iter=4000)
gPred<-predict(gmax.mod,newdata = newbers,probs = c(.25,.75,.05,.95))
plot2<-cbind(newbers,gPred)
ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))
ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))+ylim(0,1)
ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))
median(goo2$se)
newbers2<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.03),chill_weeks=c(4,4,4,4,12,12,12,12))
gPred<-predict(gmax.mod,newdata = newbers2,probs = c(.25,.75,.05,.95))
plot2<-cbind(newbers2,gPred)
ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))
newbers2<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.003),chill_weeks=c(4,4,4,4,12,12,12,12))
gPred<-predict(gmax.mod,newdata = newbers2,probs = c(.25,.75,.05,.95))
plot2<-cbind(newbers2,gPred)
ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))
newbers2<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.003),chill_weeks=c(4,4,4,4,12,12,12,12))
gPred<-predict(gmax.mod,newdata = newbers2,probs = c(.25,.75,.05,.95))
plot2<-cbind(newbers2,gPred)
ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))
newbers2<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.003),chill_weeks=c(4,4,4,4,10,10,10,10))
newbers2<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.03),chill_weeks=c(4,4,4,4,10,10,10,10))
gPred<-predict(gmax.mod,newdata = newbers2,probs = c(.25,.75,.05,.95))
plot2<-cbind(newbers2,gPred)
ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))
newbers<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.37),chill_weeks=c(4,4,4,4,10,10,10,10))
newbers2<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.03),chill_weeks=c(4,4,4,4,10,10,10,10))
ePred<-predict(e50.mod,newdata = newbers,probs = c(.25,.75,.05,.95))
gPred<-predict(gmax.mod,newdata = newbers2,probs = c(.25,.75,.05,.95))
plot<-cbind(newbers,ePred)
plot2<-cbind(newbers2,gPred)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,12))+
scale_y_continuous(breaks=c(2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,10))+
scale_y_continuous(breaks=c(2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()
ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,10))
ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,10))+ggthemes::theme_few()
get_prior(brm(Estimate|se(se,sigma=TRUE)~chill_weeks*Taxa,data=goo2)
get_prior(brm(Estimate|se(se,sigma=TRUE)~chill_weeks*Taxa,data=goo2))
get_prior(brm(Estimate|se(se,sigma=TRUE)~chill_weeks*Taxa,data=goo2))
get_prior(Estimate|se(se,sigma=TRUE)~chill_weeks*Taxa,data=goo2)
newbers<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.37),chill_weeks=c(4,4,4,4,10,10,10,10))
ePred<-predict(e50.mod,newdata = newbers,probs = c(.25,.75,.05,.95))
gPred<-predict(gmax.mod,newdata = newbers2,probs = c(.25,.75,.05,.95))
plot<-cbind(newbers,ePred)
plot2<-cbind(newbers2,gPred)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,10))+
scale_y_continuous(breaks=c(2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()
ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,10))+ggthemes::theme_few()
e50.mod %>%spread_draws() %>% head()
library(tidybayes)
e50.mod %>%spread_draws() %>% head()
newbers<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.37),chill_weeks=c(4,4,4,4,16,16,16,16))
ePred<-predict(e50.mod,newdata = newbers,probs = c(.25,.75,.05,.95))
plot<-cbind(newbers,ePred)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,10))+
scale_y_continuous(breaks=c(2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,10))+
scale_y_continuous(breaks=c(-2,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()
newbers<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.37),chill_weeks=c(4,4,4,4,13,13,13,13))
ePred<-predict(e50.mod,newdata = newbers,probs = c(.25,.75,.05,.95))
plot<-cbind(newbers,ePred)
plot2<-cbind(newbers2,gPred)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,10))+
scale_y_continuous(breaks=c(-2,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,10))+
scale_y_continuous(breaks=c(2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,10))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()
ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,10))+ggthemes::theme_few()+geom_hline(yintercept=0)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d()
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B")
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="C")
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="D")
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="D",begin = .4,end=1)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="D",begin = .1,end=.6)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="D",begin = 0,end=.6)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="D",begin = 0,end=.8)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="D",begin = 0,end=.9)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="D",begin = 0,end=1)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="D",begin = 0,end=.98)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = 0,end=.98)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = 0,end=.9)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = 0,end=.8)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = 0,end=.9)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = .1,end=.9)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = .3,end=.9)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = .5,end=.9)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = .4,end=.9)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = .4,end=.8)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = .2,end=.8)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),size=0.2)+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = .2,end=.8)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),size=0.2)+scale_x_continuous(breaks=c(4,13))+
scale_y_continuous(name = "t50",breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = .2,end=.8)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),size=0.2)+scale_x_continuous(name="weeks of chilling",breaks=c(4,13))+
scale_y_continuous(name = "t50",breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = .2,end=.8)
ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),linetype="dotted")+scale_x_continuous(breaks=c(4,10))+ggthemes::theme_few()
newbers<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.37),chill_weeks=c(4,4,4,4,10,10,10,10))
newbers2<-data.frame(Taxa=rep(unique(goo3$Taxa),2),se=(.03),chill_weeks=c(4,4,4,4,10,10,10,10))
ePred<-predict(e50.mod,newdata = newbers,probs = c(.25,.75,.05,.95))
gPred<-predict(gmax.mod,newdata = newbers2,probs = c(.25,.75,.05,.95))
plot<-cbind(newbers,ePred)
plot2<-cbind(newbers2,gPred)
ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),size=0.2)+scale_x_continuous(name="weeks of chilling",breaks=c(4,10))+
scale_y_continuous(name = "t50",breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = .2,end=.8)
ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),size=0.2)+scale_x_continuous(name="weeks of chilling",breaks=c(4,10))+
scale_y_continuous(name = "t50")+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = .2,end=.8)
ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),size=0.2)+scale_x_continuous(name="weeks of chilling",breaks=c(4,10))+
scale_y_continuous(name = "Gmax")+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = .2,end=.8)
p1<-ggplot(plot,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3.5)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),size=0.2)+scale_x_continuous(name="weeks of chilling",breaks=c(4,10))+
scale_y_continuous(name = "t50",breaks=c(0,2,4,6,8,10,12,14,16,18))+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = .2,end=.8)
p2<-ggplot(plot2,aes(chill_weeks,Estimate))+geom_point(aes(color=Taxa),size=3)+geom_errorbar(aes(ymin=`Q25`,ymax=`Q75`,color=Taxa),width=0)+
geom_smooth(method="lm",aes(color=Taxa),size=0.2)+scale_x_continuous(name="weeks of chilling",breaks=c(4,10))+
scale_y_continuous(name = "Gmax")+ggthemes::theme_few()+geom_hline(yintercept=0)+scale_color_viridis_d(option="B",begin = .2,end=.8)
ggpubr::ggarrange(p2,p1)
ggpubr::ggarrange(p2,p1,common.legend=TRUE)
ggpubr::ggarrange(p2,p1,common.legend=TRUE,legend="right")
plot(b)
