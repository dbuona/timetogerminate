cum_data_full<- within(cum_data_full, adj_total[Taxa=="Carex grayi"]<-20)
cum_data_full<- within(cum_data_full, adj_total[Taxa=="Impatiens capensis"]<-10)
cum_data_full<- within(cum_data_full, COLD[COLD==0]<-"O")
unique(cum_data_full$COLD)
#####
cum_data_A<-filter(cum_data_full,DAY>=0)
unique(cum_data_A$COLD)
cum_data_B<-filter(cum_data_full,DAY<0)
unique(cum_data_B$COLD)
cum_data_A$germ_num<-cum_data_A$germ_num+cum_data_A$chill_germ
cum_data_full<-bind_rows(cum_data_B,cum_data_A)
unique(cum_data_full$COLD)
cum_data_full$germ_perc<-cum_data_full$germ_num/cum_data_full$adj_total
cum_data_full$DAY<-ifelse(cum_data_full$DAY<0,-Inf,cum_data_full$DAY)
unique(cum_data_full$COLD)
write.csv(cum_data_full,"cumulative_data.csv")
plateid<-unique(cum_data_full$plate_num)
daily.dat<- cum_data_full %>% group_by(plate_num) %>% mutate(germ.daily = germ_num - lag(germ_num))
daily.dat$germ.daily<-ifelse(is.na(daily.dat$germ.daily),daily.dat$germ_num,daily.dat$germ.daily)
daily.dat<- daily.dat %>% group_by(plate_num) %>% mutate(END = lead(DAY))
daily.dat<-dplyr::select(daily.dat,Taxa,INC, COLD, plate_num,date,viable,DAY,END,germ.daily,mold,adj_total)
daily.dat<- cum_data_full %>% group_by(plate_num) %>% mutate(germ.daily = germ_num - lag(germ_num))
daily.dat<- daily.dat%>% group_by(plate_num) %>% mutate(germination = lag(germ.daily))
daily.dat<- cum_data_full %>% group_by(plate_num) %>% mutate(germ.daily = germ_num - lag(germ_num))
daily.dat<- daily.dat%>% group_by(plate_num) %>% mutate(germination = lead(germ.daily))
daily.dat$germination-ifelse(daily.dat$DAY==-Inf,daily.dat$germ_num,daily.dat$germination)
daily.dat<- cum_data_full %>% group_by(plate_num) %>% mutate(germ.daily = germ_num - lag(germ_num))
daily.dat<- daily.dat%>% group_by(plate_num) %>% mutate(germination = lead(germ.daily))
daily.dat$germination<-ifelse(daily.dat$DAY==-Inf,daily.dat$germ_num,daily.dat$germination)
daily.dat<- daily.dat %>% group_by(plate_num) %>% mutate(END = lead(DAY))
daily.dat<-dplyr::select(daily.dat,Taxa,INC, COLD, plate_num,date,viable,DAY,END,germ.daily,mold,adj_total)
daily.dat$end<-ifelse(is.na(daily.dat$END),Inf,daily.dat$END)
daily.dat<- cum_data_full %>% group_by(plate_num) %>% mutate(germ.daily = germ_num - lag(germ_num))
daily.dat<- daily.dat%>% group_by(plate_num) %>% mutate(germination = lead(germ.daily))
daily.dat$germination<-ifelse(daily.dat$DAY==-Inf,daily.dat$germ_num,daily.dat$germination)
daily.dat<- daily.dat %>% group_by(plate_num) %>% mutate(END = lead(DAY))
daily.dat<-dplyr::select(daily.dat,Taxa,INC, COLD, plate_num,date,viable,DAY,END,germ.daily,mold,adj_total)
daily.dat$end<-ifelse(is.na(daily.dat$END),Inf,daily.dat$END)
daily.dat<- cum_data_full %>% group_by(plate_num) %>% mutate(germ.daily = germ_num - lag(germ_num))
daily.dat<- daily.dat%>% group_by(plate_num) %>% mutate(germination = lead(germ.daily))
daily.dat$germination<-ifelse(daily.dat$DAY==-Inf,daily.dat$germ_num,daily.dat$germination)
daily.dat<- daily.dat %>% group_by(plate_num) %>% mutate(END = lead(DAY))
daily.dat<-dplyr::select(daily.dat,Taxa,INC, COLD, plate_num,date,viable,DAY,END,germ.daily,mold,adj_total)
daily.dat<- daily.dat%>% group_by(plate_num) %>% mutate(germination = lead(germ.daily))
daily.dat$END<-daily.dat$DAY
daily.dat<- daily.dat %>% group_by(plate_num) %>% mutate(START = lag(END))
daily.dat$START<-ifelse(is.na(daily.dat$START),-Inf,daily.dat$START)
daily.dat<-dplyr::select(daily.dat,Taxa,INC, COLD, plate_num,date,viable,DAY,START,END,germ.daily,germination,mold,adj_total)
daily.dat<- cum_data_full %>% group_by(plate_num) %>% mutate(germ.daily = germ_num - lag(germ_num))
daily.dat<- daily.dat%>% group_by(plate_num) %>% mutate(germination = lead(germ.daily))
daily.dat$germination<-ifelse(daily.dat$DAY==-Inf,daily.dat$germ_num,daily.dat$germination)
daily.dat<- daily.dat %>% group_by(plate_num) %>% mutate(END = lead(DAY))
daily.dat$germination<-ifelse(daily.dat$DAY==-Inf,daily.dat$germ_num,daily.dat$germination)
daily.dat<-dplyr::select(daily.dat,Taxa,INC, COLD, plate_num,date,viable,DAY,END,germination,mold,adj_total)
daily.dat$END<-ifelse(is.na(daily.dat$END),Inf,daily.dat$END)
daily.dat$germination<-ifelse(is.na(daily.dat$germination),daily.dat$viable,daily.dat$germination)
unique(daily.dat$plate_num)
daily.dat$force<-ifelse(daily.dat$INC=="H",25,20)
daily.dat$germ_perc<-daily.dat$germination/daily.dat$adj_total
write.csv(daily.dat,"germ_data_forDRC.csv")
d<-read.csv("germ_data_forDRC.csv",header= TRUE)
d<-filter(d, !Taxa %in% c("Phlox cuspidata","Impatiens capensis", "Carex grisea"))
specieslist<-sort(unique(d$Taxa))
#<- within(d, germ[datasetID=="caffara11b" & response.time==""]
X<-split(d, with(d, d$Taxa  ), drop = TRUE)
Y <- lapply(seq_along(X), function(x) as.data.frame(X[[x]])[, 1:14])
names(Y) <-(c(specieslist))
list2env(Y, envir = .GlobalEnv)
drm(germination~start+end, factor(INC):factor(COLD), data = `Anemone virginana`, fct = LL.2(), type ="event")
drm(germination~DAY+END, factor(INC):factor(COLD), data = `Anemone virginana`, fct = LL.2(), type ="event")
noncens<-filter(d,start==25 & germination!=0)
View(d)
rm(list=ls())
options(stringsAsFactors = FALSE)
setwd("~/Documents/git/timetogerminate/germination_trials/input")
library(tidyverse)
library(lubridate)
library("Hmisc")
library(drc)
d<-read.csv("germ_data_forDRC.csv",header= TRUE)
d<-filter(d, !Taxa %in% c("Phlox cuspidata","Impatiens capensis", "Carex grisea"))
specieslist<-sort(unique(d$Taxa))
#<- within(d, germ[datasetID=="caffara11b" & response.time==""]
d<-anti_join(d, noncens)
specieslist<-sort(unique(d$Taxa))
X<-split(d, with(d, d$Taxa  ), drop = TRUE)
Y <- lapply(seq_along(X), function(x) as.data.frame(X[[x]])[, 1:14])
names(Y) <-(c(specieslist))
list2env(Y, envir = .GlobalEnv)
drm(germination~DAY+END, factor(INC):factor(COLD), data = `Anemone virginana`, fct = LL.2(), type ="event")
drm(germination~DAY+END, factor(INC):factor(COLD), data = `Anemone virginana`, fct = LL.2(), type ="Continuous")
drm(germination~DAY+END, factor(INC):factor(COLD), data = `Anemone virginana`, fct = LL.2(), type ="event",separate=TRUE)
drm(germination~DAY+END, factor(INC):factor(COLD), data = `Anemone virginana`, fct = LL.2(), type ="event",robust="lms")
View(`Anemone virginana`)
drm(germination~DAY+END, factor(COLD), data = `Anemone virginana`, fct = LL.2(), type ="event")
drm(germination~DAY+END, data = `Anemone virginana`, fct = LL.2(), type ="event")
drm(germination~DAY+END, data = `Anemone virginana`, fct = LL.3(), type ="event")
drm(germination~DAY+END, data = `Anemone virginana`, fct = LL.4(), type ="event")
drm(germination~DAY+END, data = `Anemone virginana`, fct = LL.5(), type ="event")
drm(germination~DAY+END, data = `Anemone virginana`, fct = LL.3u(), type ="event")
drm(germination~DAY+END, data = `Anemone virginana`, fct = LL.2(), type ="event")
drm(germination~DAY+END,factor(INC), data = `Anemone virginana`, fct = LL.2(), type ="event")
Modelit<-function(x,y,z){y<-drm(germination~start+end, factor(INC):factor(COLD), data = x, fct = LL.2(), type ="event")
z<-as.data.frame(ED(y,c(50)))}
Av<-Modelit(`Anemone virginana`)
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(), type ="event")
z<-as.data.frame(ED(y,c(50)))}
##nothing converges
Av<-Modelit(`Anemone virginana`)
As<-Modelit(`Asclepias syriaca`)
Cc<-Modelit(`Cryptotaenia canadensis`)
Ed<-Modelit(`Eurbia diviricata`)
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(), type ="event",separate=TRUE)
z<-as.data.frame(ED(y,c(50)))}
##nothing converges
Av<-Modelit(`Anemone virginana`)
As<-Modelit(`Asclepias syriaca`)
Cc<-Modelit(`Cryptotaenia canadensis`)
Ed<-Modelit(`Eurbia diviricata`)
Hm<-Modelit(`Hesperis matronalis`)
OB<-Modelit(`Oenethera biennis`)
Pv<-Modelit(`Polygonum virginiatum`)
Ss<-Modelit(`Silene stellata`)
Sv<-Modelit(`Silene vulgaris`)
Td<-Modelit(`Thalictrum dioicum`)
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, plate_num, data = x, fct = LL.2(), type ="event",separate=TRUE)
z<-as.data.frame(ED(y,c(50)))}
##nothing converges
Av<-Modelit(`Anemone virginana`)
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(fixed = c(NA, 0, 1, NA)), type ="event",separate=TRUE,)
z<-as.data.frame(ED(y,c(50)))}
Av<-Modelit(`Anemone virginana`)
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.4(fixed = c(NA, 0, 1, NA)), type ="event",separate=TRUE,)
z<-as.data.frame(ED(y,c(50)))}
##nothing converges
Av<-Modelit(`Anemone virginana`)
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(fixed = c(10, NA)), type ="event",separate=TRUE,)
z<-as.data.frame(ED(y,c(50)))}
##nothing converges
Av<-Modelit(`Anemone virginana`)
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(fixed = c(15, NA)), type ="event",separate=TRUE,)
z<-as.data.frame(ED(y,c(50)))}
##nothing converges
Av<-Modelit(`Anemone virginana`)
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(fixed = c(NA, 15)), type ="event",separate=TRUE,)
z<-as.data.frame(ED(y,c(50)))}
##nothing converges
Av<-Modelit(`Anemone virginana`)
As<-Modelit(`Asclepias syriaca`)
Cc<-Modelit(`Cryptotaenia canadensis`)
Ed<-Modelit(`Eurbia diviricata`)
Hm<-Modelit(`Hesperis matronalis`)
OB<-Modelit(`Oenethera biennis`)
Pv<-Modelit(`Polygonum virginiatum`)
Ss<-Modelit(`Silene stellata`)
Sv<-Modelit(`Silene vulgaris`)
Td<-Modelit(`Thalictrum dioicum`)
Av.f<-filter(`Anemone virginana`,COLD="f")
Av.f<-filter(`Anemone virginana`,COLD=="f")
drm(germination~DAY+END,factor(INC), data = `Av.f`, fct = LL.2(), type ="event")
nonstartsense<-filter(d,END==0 & germination!=0)
noendsense<-filter(d,END==Inf,germination!=0)
View(nonstartsense)
d<-anti_join(d, nonstartcens)
nonstartcens<-filter(d,END==0 & germination!=0)
noendcense<-filter(d,END==Inf,germination!=0)
d<-anti_join(d, nonstartcens)
d<-read.csv("germ_data_forDRC.csv",header= TRUE)
d<-filter(d, !Taxa %in% c("Phlox cuspidata","Impatiens capensis", "Carex grisea"))
specieslist<-sort(unique(d$Taxa))
nonstartcens<-filter(d,END==0 & germination!=0)
noendcense<-filter(d,END==Inf,germination!=0)
rm(list=ls())
options(stringsAsFactors = FALSE)
setwd("~/Documents/git/timetogerminate/germination_trials/input")
library(tidyverse)
library(lubridate)
library("Hmisc")
library(drc)
d<-read.csv("germ_data_forDRC.csv",header= TRUE)
d<-filter(d, !Taxa %in% c("Phlox cuspidata","Impatiens capensis", "Carex grisea"))
specieslist<-sort(unique(d$Taxa))
nonstartcens<-filter(d,END==0 & germination!=0)
noendcense<-filter(d,END==Inf,germination!=0)
d<-anti_join(d, nonstartcens)
d<-anti_join(d,noendcense)
X<-split(d, with(d, d$Taxa  ), drop = TRUE)
Y <- lapply(seq_along(X), function(x) as.data.frame(X[[x]])[, 1:14])
names(Y) <-(c(specieslist))
list2env(Y, envir = .GlobalEnv)
Av.f<-filter(`Anemone virginana`,COLD=="f")
drm(germination~DAY+END,factor(INC), data = `Av.f`, fct = LL.2(), type ="event")
Av.f<-filter(`Anemone virginana`,COLD=="A")
drm(germination~DAY+END,factor(INC), data = `Av.f`, fct = LL.2(), type ="event")
Av.f<-filter(`Anemone virginana`,COLD=="A")
Av.f<-filter(`Anemone virginana`,COLD=="O")
View(Av.f)
d<-read.csv("germ_data_forDRC.csv",header= TRUE)
d<-filter(d, !Taxa %in% c("Phlox cuspidata","Impatiens capensis", "Carex grisea"))
specieslist<-sort(unique(d$Taxa))
###remove infinity rows with no left of right censoring
nonstartcens<-filter(d,END==0 & germination!=0)
noendcense<-filter(d,END==Inf,germination!=0)
d<-anti_join(d, nonstartcens)
d<-anti_join(d,noendcense)
View(d)
nonstartcens<-filter(d,END==0 & germination==0)
nonstartcens<-filter(d,END==0 & germination==0)
noendcense<-filter(d,END==Inf,germination!=0)
d<-anti_join(d, nonstartcens)
d<-anti_join(d,noendcense)
### make each species its own data frame
X<-split(d, with(d, d$Taxa), drop = TRUE)
Y <- lapply(seq_along(X), function(x) as.data.frame(X[[x]])[, 1:14])
names(Y) <-(c(specieslist))
list2env(Y, envir = .GlobalEnv)
Av.f<-filter(`Anemone virginana`,COLD=="O")
drm(germination~DAY+END,factor(INC), data = `Av.f`, fct = LL.2(), type ="event")
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(fixed = c(NA, 15)), type ="event",separate=TRUE,)
z<-as.data.frame(ED(y,c(50)))}
##nothing converges
Av<-Modelit(`Anemone virginana`)
As<-Modelit(`Asclepias syriaca`)
Cc<-Modelit(`Cryptotaenia canadensis`)
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(fixed = c(NA, 15)), type ="event",separate=TRUE,)
z<-as.data.frame(ED(y,c(50)))}
##nothing converges
Av<-Modelit(`Anemone virginana`)
Av.f<-filter(`Anemone virginana`)
drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.2(), type ="event")
Av<-dplyr::filter(`Anemone virginana`)
drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.2(), type ="event")
goo<-drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.2(), type ="event")
eD(goo,(50))
ED(goo,(50))
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(fixed = c(NA, 15)), type ="event",separate=TRUE,)
z<-as.data.frame(ED(y,c(50)))}
Av<-Modelit(`Anemone virginana`)
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(fixed = c(NA, 15)), type ="event",separate=TRUE)
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(fixed = c(NA, 15)), type ="event",separate=TRUE)
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(fixed = c(NA, 15)), type ="event",separate=TRUE)
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(fixed = c(NA, 15)), type ="event",separate=TRUE)
z<-as.data.frame(ED(y,c(50)))}
)))
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(fixed = c(NA, 15)), type ="event",separate=TRUE)
z<-as.data.frame(ED(y,c(50)))}
##nothing converges
Av<-Modelit(`Anemone virginana`)
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(), type ="event")
z<-as.data.frame(ED(y,c(50)))}
##nothing converges
Av<-Modelit(`Anemone virginana`)
As<-Modelit(`Asclepias syriaca`)
Cc<-Modelit(`Cryptotaenia canadensis`)
Ed<-Modelit(`Eurbia diviricata`)
Hm<-Modelit(`Hesperis matronalis`)
OB<-Modelit(`Oenethera biennis`)
Pv<-Modelit(`Polygonum virginiatum`)
Ss<-Modelit(`Silene stellata`)
View(`Silene stellata`)
d<-read.csv("germ_data_forDRC.csv",header= TRUE)
d<-filter(d, !Taxa %in% c("Phlox cuspidata","Impatiens capensis", "Carex grisea"))
specieslist<-sort(unique(d$Taxa))
###remove infinity rows with no left of right censoring
nonstartcens<-filter(d,END==0 & germination==0)
noendcense<-filter(d,END==Inf,germination==0)
d<-anti_join(d, nonstartcens)
d<-anti_join(d,noendcense)
### make each species its own data frame
X<-split(d, with(d, d$Taxa), drop = TRUE)
Y <- lapply(seq_along(X), function(x) as.data.frame(X[[x]])[, 1:14])
names(Y) <-(c(specieslist))
list2env(Y, envir = .GlobalEnv)
Av<-dplyr::filter(`Anemone virginana`)
goo<-drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.2(), type ="event")
ED(goo,(50))
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(), type ="event")
z<-as.data.frame(ED(y,c(50)))}
##nothing converges
Av<-Modelit(`Anemone virginana`)
As<-Modelit(`Asclepias syriaca`)
Cc<-Modelit(`Cryptotaenia canadensis`)##no converge
Ed<-Modelit(`Eurbia diviricata`)
Ed<-Modelit(`Eurbia diviricata`)
View(`Eurbia diviricata`)
Hm<-Modelit(`Hesperis matronalis`)##
OB<-Modelit(`Oenethera biennis`)
Pv<-Modelit(`Polygonum virginiatum`)###
Ss<-Modelit(`Silene stellata`)
Sv<-Modelit(`Silene vulgaris`)
Td<-Modelit(`Thalictrum dioicum`)
Av<-Modelit(`Anemone virginana`)
goo<-drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.3(), type ="event")
goo<-drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.2(), type ="event")
ED(goo,(50))
summary(goo)
90+18
19+18
drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.3(), type ="event", start = c(coef(goo)[1:13], coef(goo)[19:37]))
drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.3(), type ="event", start = c(coef(goo)[1:26], coef(goo)[27:54]))
drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.3(), type ="event", start = c(coef(goo)[1:13],NA, coef(goo)[19:37]))
drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.3(), type ="event", start = c(coef(goo)[1:18],rep(0.7,13), coef(goo)[19:37]))
germLL.2 <- drm(germinated ~ start + end, species:factor(temp),
data = germination[c(1:23, 25:61, 63:192), ], fct = LL.2(), type = "event")
plot(germLL.2, ylim=c(0, 1.5), legendPos=c(2.5,1.5))  # plotting the fitted curves and the data
summary(germLL.2)
drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.3(), type ="event", start = c(coef(goo)[1:18],rep(0.7,18), coef(goo)[19:37]))
coef(germLL.2)[1:13]
rep(1, 13)
rep(0.7,13)
coef(germLL.2)[14:26]
coef(goo)[1:18]
coef(goo)[1:26]
coef(goo)[1:19]
coef(goo)[19:37]
drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.3(), type ="event", start = c(coef(goo)[1:18],rep(1,18), coef(goo)[19:36]))
drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.3(), type ="event", start = c(coef(goo)[1:18],rep(0,18), coef(goo)[19:36]),upper = c(rep(Inf, 18), rep(1, 13), rep(Inf, 18)))
drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.3(), type ="event", start = c(coef(goo)[1:18],rep(-Inf,18), coef(goo)[19:36]),upper = c(rep(Inf, 18), rep(1, 13), rep(Inf, 18)))
drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.3(), type ="event", start = c(coef(goo)[1:18],rep(-Inf,18), coef(goo)[19:36]),upperl = c(rep(Inf, 18), rep(1, 13), rep(Inf, 18)))
drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.3(), type ="event", lowerl = c(coef(goo)[1:18],rep(-Inf,18), coef(goo)[19:36]),upperl = c(rep(Inf, 18), rep(1, 13), rep(Inf, 18)))
drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.3(), type ="event", start = c(coef(goo)[1:18],rep(-Inf,18), coef(goo)[19:36])))
drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.3(), type ="event", start = c(coef(goo)[1:18],rep(-Inf,18), coef(goo)[19:36]))
goo<-drm(germination~DAY+END,factor(INC):factor(COLD), data = `Av.f`, fct = LL.2(), type ="event")
summary(goo)
plot(goo)
plot(goo, ylim=c(0, 25))
plot(goo, xlim=c(0, 25))
plot(goo, xlim=c(1,25))
plot(goo, ylim=c(0.1.2))
plot(goo, ylim=c(0,1.2))
plot(goo, ylim=c(0,1.2),legendPos=c(2.5,1.5))
plot(goo, ylim=c(0,1.2),legendPos=c(2.5,1))
Av.H<-dplyr::filter(`Anemone virginana`,INC=="H")
goo<-drm(germination~DAY+END,factor(COLD), data = `Av.H`, fct = LL.2(), type ="event")
summary(goo)
plot(goo, ylim=c(0,1.2),legendPos=c(2.5,1))
plot(goo,xlim=c(1,25), ylim=c(0,1.2),legendPos=c(2.5,1))
germination[c(1:23, 25:61, 63:192), ]
plot(germLL.2, ylim=c(0, 1.5), legendPos=c(2.5,1.5))  # plotting the fitted curves and the data
ED(goo,(50))
As.H<-dplyr::filter(`Asclepias syriaca`,INC=="H")
goo<-drm(germination~DAY+END,factor(COLD), data = `As.H`, fct = LL.2(), type ="event")
summary(goo)
plot(goo,xlim=c(1,25), ylim=c(0,1.2),legendPos=c(2.5,1))
ED(goo,(50))
plot(goo,xlim=c(0,25), ylim=c(0,1.2),legendPos=c(2.5,1))
View(`Polygonum virginiatum`)
As.H<-dplyr::filter(`Cryptotaenia canadensis`,INC=="H")
goo<-drm(germination~DAY+END,factor(COLD), data = `As.H`, fct = LL.2(), type ="event")
As.L<-dplyr::filter(`Asclepias syriaca`,INC=="L")
goo<-drm(germination~DAY+END,factor(COLD), data = `As.L`, fct = LL.2(), type ="event")
summary(goo)
plot(goo,xlim=c(0,25), ylim=c(0,1.2),legendPos=c(2.5,1))
plot(goo,xlim=c(1,25), ylim=c(0,1.2),legendPos=c(2.5,1))
ED(goo,(50))
z<-as.data.frame(ED(y,c(90)))}
ED(goo,(90))
d.nocen<-filter(d,END!="Inf")
d.nocen<-filter(d,END!=Inf)
d.nocen<-filter(d,DAY!=Inf)
d.nocen<-filter(d,END!=Inf)
d.nocen<-filter(d.nocen,DAY!=Inf)
d.nocen<-filter(d,END!=Inf)
d<-read.csv("germ_data_forDRC.csv",header= TRUE)
d<-filter(d, !Taxa %in% c("Phlox cuspidata","Impatiens capensis", "Carex grisea"))
specieslist<-sort(unique(d$Taxa))
###remove infinity rows with no left of right censoring
nonstartcens<-filter(d,END==0 & germination==0)
noendcense<-filter(d,END==Inf,germination==0)
d<-anti_join(d, nonstartcens)
d<-anti_join(d,noendcense)
rm(list=ls())
options(stringsAsFactors = FALSE)
setwd("~/Documents/git/timetogerminate/germination_trials/input")
library(tidyverse)
library(lubridate)
library("Hmisc")
library(drc)
d<-read.csv("germ_data_forDRC.csv",header= TRUE)
d<-filter(d, !Taxa %in% c("Phlox cuspidata","Impatiens capensis", "Carex grisea"))
specieslist<-sort(unique(d$Taxa))
###remove infinity rows with no left of right censoring
nonstartcens<-filter(d,END==0 & germination==0)
noendcense<-filter(d,END==Inf,germination==0)
d<-anti_join(d, nonstartcens)
d<-anti_join(d,noendcense)
d.nocen<-filter(d,END!=Inf)
d.nocen<-filter(d.nocen,DAY!=-Inf)
X<-split(d.nocen, with(d.nocen, d.nocen$Taxa), drop = TRUE)
Y <- lapply(seq_along(X), function(x) as.data.frame(X[[x]])[, 1:14])
names(Y) <-(c(specieslist))
list2env(Y, envir = .GlobalEnv)
As.L<-dplyr::filter(`Asclepias syriaca`,INC=="L")
goo<-drm(germination~DAY+END,factor(COLD), data = `As.L`, fct = LL.2(), type ="event")
summary(goo)
plot(goo,xlim=c(1,25), ylim=c(0,1.2),legendPos=c(2.5,1))
ED(goo,(90))
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(), type ="event")
z<-as.data.frame(ED(y,c(50))}
Modelit<-function(x,y,z){y<-drm(germination~DAY+END, factor(INC):factor(COLD), data = x, fct = LL.2(), type ="event")
z<-as.data.frame(ED(y,c(50)))}
Av<-Modelit(`Anemone virginana`)
As<-Modelit(`Asclepias syriaca`)
Cc<-Modelit(`Cryptotaenia canadensis`)##no converge
Cc
As
Hm<-Modelit(`Hesperis matronalis`)##
OB<-Modelit(`Oenethera biennis`)##
Pv<-Modelit(`Polygonum virginiatum`)###
Ss<-Modelit(`Silene stellata`)
Sv<-Modelit(`Silene vulgaris`)
Td<-Modelit(`Thalictrum dioicum`)
plot(Ss)
X<-split(d, with(d, d$Taxa), drop = TRUE)
Y <- lapply(seq_along(X), function(x) as.data.frame(X[[x]])[, 1:14])
names(Y) <-(c(specieslist))
list2env(Y, envir = .GlobalEnv)
Poly.L<-dplyr::filter(`Polygonum virginiatum`,INC=="L")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="G")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
summary(goo)
plot(goo,xlim=c(1,25), ylim=c(0,1.2),legendPos=c(2.5,1))
ED(goo,(90))
goo<-drm(germination~DAY+END, data = Poly.L, fct = LL.2(), type ="event")
goo<-drm(germination~DAY+END,COLD, data = Poly.L, fct = LL.2(), type ="event")
goo<-drm(germination~DAY+END,factor(COLD), data = Poly.L, fct = LL.2(), type ="event")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="O")
goo<-drm(germination~DAY+END, data = PolyL.G.L, fct = LL.2(), type ="event")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="O")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="A")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="B")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
summary(goo)
PolyL.G.<-dplyr::filter(Poly.L,COLD=="C")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
summary(goo)
PolyL.G.<-dplyr::filter(Poly.L,COLD=="D")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
summary(goo)
PolyL.G.<-dplyr::filter(Poly.L,COLD=="D")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
summary(goo)
PolyL.G.<-dplyr::filter(Poly.L,COLD=="E")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
summary(goo)
Poly.L<-dplyr::filter(`Polygonum virginiatum`,INC=="L")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="F")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="f")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
summary(goo)
PolyL.G.<-dplyr::filter(Poly.L,COLD=="G")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
summary(goo)
PolyL.G.<-dplyr::filter(Poly.L,COLD=="H")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="H")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="H")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
d<-read.csv("germ_data_forDRC.csv",header= TRUE)
unique(d$COLD)
d<-filter(d, !Taxa %in% c("Phlox cuspidata","Impatiens capensis", "Carex grisea"))
specieslist<-sort(unique(d$Taxa))
###remove infinity rows with no left of right censoring
nonstartcens<-filter(d,END==0 & germination==0)
noendcense<-filter(d,END==Inf,germination==0)
d<-anti_join(d, nonstartcens)
d<-anti_join(d,noendcense)
####model without censoring
d.nocen<-filter(d,END!=Inf)
d.nocen<-filter(d.nocen,DAY!=-Inf)
### make each species its own data frame
X<-split(d, with(d, d$Taxa), drop = TRUE)
Y <- lapply(seq_along(X), function(x) as.data.frame(X[[x]])[, 1:14])
names(Y) <-(c(specieslist))
list2env(Y, envir = .GlobalEnv)
#=============================drc example
Poly.L<-dplyr::filter(`Polygonum virginiatum`,INC=="L")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="H")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="H")
Poly.L<-dplyr::filter(`Polygonum virginiatum`,INC=="H")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="H")
Poly.L<-dplyr::filter(`Cryptotaenia canadensis`,INC=="L")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="O")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="A")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
summary(goo)
PolyL.G.<-dplyr::filter(Poly.L,COLD=="B")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
summary(goo)
PolyL.G.<-dplyr::filter(Poly.L,COLD=="C")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
summary(goo)
PolyL.G.<-dplyr::filter(Poly.L,COLD=="D")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
summary(goo)
PolyL.G.<-dplyr::filter(Poly.L,COLD=="E")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
summary(goo)
PolyL.G.<-dplyr::filter(Poly.L,COLD=="f")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
summary(goo)
PolyL.G.<-dplyr::filter(Poly.L,COLD=="G")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
PolyL.G.<-dplyr::filter(Poly.L,COLD=="H")
goo<-drm(germination~DAY+END, data = PolyL.G., fct = LL.2(), type ="event")
