(chill.beta*chilltreat[i]*betahere)))
y <- rbind(y, yhere)
}
# I add in sigma_y here...
# dfrepadd <- data.frame(time=time, y=rnorm(length(y), y, sigma_y), ID=rep(i, length(y)),
# chilltreat=chilltreathere)
#dfhere <- rbind(dfhere, dfrepadd)
# }
df <- rbind(df, dfhere)
}
}
sigma_y <- 0 #Q2 do I need this or is it really a product of error on the parament estimates
df <- data.frame(time=numeric(), y=numeric(), ID=numeric(), chilltreat=numeric())
for(i in c(1:length(chilltreat))){ # i <- 1
chilltreathere <- chilltreat[i]
for(j in c(1:length(d_a))){ # j <- 1
d.muhere <- da[j]
t50here <- t50_a[j]
betahere <- beta_a[j]
dfhere <- data.frame(time=numeric(), y=numeric(), ID=numeric(), chilltreat=numeric())
# This next equation needs to more closely match your stan code.
# Here's the critcial bits of the stan model
# y_hat[i] =(b_chill_d*chill[i]+a_d)/
# (1+(((t[i])/(b_chill_t50*chill[i]+a_t50))^(b_chill_beta*chill[i]+a_beta)))
# Also note: The only sigma you probably need in your Stan model is this one:
# Y ~ normal(y_hat, sigma)
# But you had three more below ... need to adjust .... here's my basic idea of how it should work
for(k in 1:repz){
y <- c()
for (l in c(1:length(time))){
yhere <- (chill.d*chilltreat[i]+d.muhere)/
(1+((time[l]/(chill.t50*chilltreat[i]+t50here))^
(chill.beta*chilltreat[i]*betahere)))
y <- rbind(y, yhere)
}
# I add in sigma_y here...
dfrepadd <- data.frame(time=time, y=rnorm(length(y), y, sigma_y), ID=rep(i, length(y)),
chilltreat=chilltreathere)
dfhere <- rbind(dfhere, dfrepadd)
}
df <- rbind(df, dfhere)
}
}
)))
df <- data.frame(time=numeric(), y=numeric(), ID=numeric(), chilltreat=numeric())
for(i in c(1:length(chilltreat))){ # i <- 1
chilltreathere <- chilltreat[i]
for(j in c(1:length(d_a))){ # j <- 1
d.muhere <- da[j]
t50here <- t50_a[j]
betahere <- beta_a[j]
dfhere <- data.frame(time=numeric(), y=numeric(), ID=numeric(), chilltreat=numeric())
# This next equation needs to more closely match your stan code.
# Here's the critcial bits of the stan model
# y_hat[i] =(b_chill_d*chill[i]+a_d)/
# (1+(((t[i])/(b_chill_t50*chill[i]+a_t50))^(b_chill_beta*chill[i]+a_beta)))
# Also note: The only sigma you probably need in your Stan model is this one:
# Y ~ normal(y_hat, sigma)
# But you had three more below ... need to adjust .... here's my basic idea of how it should work
for(k in 1:repz){
y <- c()
for (l in c(1:length(time))){
yhere <- (chill.d*chilltreat[i]+d.muhere)/
(1+((time[l]/(chill.t50*chilltreat[i]+t50here))^
(chill.beta*chilltreat[i]*betahere)))
y <- rbind(y, yhere)
}
# I add in sigma_y here...
dfrepadd <- data.frame(time=time, y=rnorm(length(y), y, sigma_y), ID=rep(i, length(y)),
chilltreat=chilltreathere)
dfhere <- rbind(dfhere, dfrepadd)
}
df <- rbind(df, dfhere)
}
}
for(i in c(1:length(chilltreat))){ # i <- 1
chilltreathere <- chilltreat[i]
for(j in c(1:length(d_a))){ # j <- 1
d.muhere <- d_a[j]
t50here <- t50_a[j]
betahere <- beta_a[j]
dfhere <- data.frame(time=numeric(), y=numeric(), ID=numeric(), chilltreat=numeric())
# This next equation needs to more closely match your stan code.
# Here's the critcial bits of the stan model
# y_hat[i] =(b_chill_d*chill[i]+a_d)/
# (1+(((t[i])/(b_chill_t50*chill[i]+a_t50))^(b_chill_beta*chill[i]+a_beta)))
# Also note: The only sigma you probably need in your Stan model is this one:
# Y ~ normal(y_hat, sigma)
# But you had three more below ... need to adjust .... here's my basic idea of how it should work
for(k in 1:repz){
y <- c()
for (l in c(1:length(time))){
yhere <- (chill.d*chilltreat[i]+d.muhere)/
(1+((time[l]/(chill.t50*chilltreat[i]+t50here))^
(chill.beta*chilltreat[i]*betahere)))
y <- rbind(y, yhere)
}
# I add in sigma_y here...
dfrepadd <- data.frame(time=time, y=rnorm(length(y), y, sigma_y), ID=rep(i, length(y)),
chilltreat=chilltreathere)
dfhere <- rbind(dfhere, dfrepadd)
}
df <- rbind(df, dfhere)
}
}
View(dfhere)
d_a <- 4 ###max # of seeds germinated if chilling is 0
d_a <- 6 ###max # of seeds germinated if chilling is 0
t50_a <- 20 ### time to 50% germination if chilling is zero
beta_a <- -4  ##slope of growth curve if chillign is 0
chill.d <- 5  ##slope of d with chilling
chill.t50 <- -10  ### slope of t50 change with chilling
chill.beta <- -3  ## how growth curve slope changes
sigma_y <- 0.1 #Q2 do I need this or is it really a product of error on the parament estimates
df <- data.frame(time=numeric(), y=numeric(), ID=numeric(), chilltreat=numeric())
for(i in c(1:length(chilltreat))){ # i <- 1
chilltreathere <- chilltreat[i]
for(j in c(1:length(d_a))){ # j <- 1
d.muhere <- d_a[j]
t50here <- t50_a[j]
betahere <- beta_a[j]
dfhere <- data.frame(time=numeric(), y=numeric(), ID=numeric(), chilltreat=numeric())
# This next equation needs to more closely match your stan code.
# Here's the critcial bits of the stan model
# y_hat[i] =(b_chill_d*chill[i]+a_d)/
# (1+(((t[i])/(b_chill_t50*chill[i]+a_t50))^(b_chill_beta*chill[i]+a_beta)))
# Also note: The only sigma you probably need in your Stan model is this one:
# Y ~ normal(y_hat, sigma)
# But you had three more below ... need to adjust .... here's my basic idea of how it should work
for(k in 1:repz){
y <- c()
for (l in c(1:length(time))){
yhere <- (chill.d*chilltreat[i]+d.muhere)/
(1+((time[l]/(chill.t50*chilltreat[i]+t50here))^
(chill.beta*chilltreat[i]*betahere)))
y <- rbind(y, yhere)
}
# I add in sigma_y here...
dfrepadd <- data.frame(time=time, y=rnorm(length(y), y, sigma_y), ID=rep(i, length(y)),
chilltreat=chilltreathere)
dfhere <- rbind(dfhere, dfrepadd)
}
df <- rbind(df, dfhere)
}
}
test.dat <- df
test.dat$y <- round(test.dat$y)
View(test.dat)
d_a <- rtnorm(1,6,2,lower=0,upper=20) ###max # of seeds germinated if chilling is 0
library(MCMCglmm) #repz <- 10
chilltreat <- c(0, 1) # We need to use this in the equation! Just the way you do in Stan
d_a <- rtnorm(1,6,2,lower=0,upper=20) ###max # of seeds germinated if chilling is 0
t50_a <- rnorm(1,20,1) ### time to 50% germination if chilling is zero
beta_a <- rnorm(1,-4,0.2)  ##slope of growth curve if chillign is 0
chill.d <- 5  ##slope of d with chilling
chill.t50 <- -10  ### slope of t50 change with chilling
chill.beta <- -3  ## how growth curve slope changes
sigma_y <- 0.1 #Q2 do I need this or is it really a product of error on the parament estimates
df <- data.frame(time=numeric(), y=numeric(), ID=numeric(), chilltreat=numeric())
for(i in c(1:length(chilltreat))){ # i <- 1
chilltreathere <- chilltreat[i]
for(j in c(1:length(d_a))){ # j <- 1
d.muhere <- d_a[j]
t50here <- t50_a[j]
betahere <- beta_a[j]
dfhere <- data.frame(time=numeric(), y=numeric(), ID=numeric(), chilltreat=numeric())
# This next equation needs to more closely match your stan code.
# Here's the critcial bits of the stan model
# y_hat[i] =(b_chill_d*chill[i]+a_d)/
# (1+(((t[i])/(b_chill_t50*chill[i]+a_t50))^(b_chill_beta*chill[i]+a_beta)))
# Also note: The only sigma you probably need in your Stan model is this one:
# Y ~ normal(y_hat, sigma)
# But you had three more below ... need to adjust .... here's my basic idea of how it should work
for(k in 1:repz){
y <- c()
for (l in c(1:length(time))){
yhere <- (chill.d*chilltreat[i]+d.muhere)/
(1+((time[l]/(chill.t50*chilltreat[i]+t50here))^
(chill.beta*chilltreat[i]*betahere)))
y <- rbind(y, yhere)
}
# I add in sigma_y here...
dfrepadd <- data.frame(time=time, y=rnorm(length(y), y, sigma_y), ID=rep(i, length(y)),
chilltreat=chilltreathere)
dfhere <- rbind(dfhere, dfrepadd)
}
df <- rbind(df, dfhere)
}
}
test.dat <- df
test.dat$y <- round(test.dat$y)
plot(mod3,ylim=c(0,20),xlim=c(0,24),log="",pch=16)
plot(y~time, data=test.dat)
View(test.dat)
### for figure
###fake data for germination mdodels
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(tidyverse)
library(drc)
setwd("~/Documents/git/timetogerminate/germination_trials")
real.data<-read.csv("input/daily_dat_nointerval.csv")
real.data<- real.data %>% group_by(plate_num)%>% mutate(germ.cum=cumsum(germ.daily))
### for figure
###fake data for germination mdodels
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(tidyverse)
library(drc)
setwd("~/Documents/git/timetogerminate/germination_trials")
real.data<-read.csv("input/daily_dat_nointerval.csv")
real.data<- real.data %>% group_by(plate_num)%>% mutate(germ.cum=cumsum(germ.daily))
unique(real.data$Taxa)
comp<-real.data %>% filter(Taxa %in% c("Cryptotaenia canadensis","Hesperis matronalis"))
comp<-real.data %>% filter(Taxa %in% c("Cryptotaenia canadensis","Hesperis matronalis","Eurbia diviricata"))
real.data<-read.csv("input/daily_dat_nointerval.csv")
real.data<- real.data %>% group_by(plate_num)%>% mutate(germ.cum=cumsum(germ.daily))
unique(real.data$Taxa)
comp<-real.data %>% filter(Taxa %in% c("Cryptotaenia canadensis","Hesperis matronalis","Eurbia diviricata"))
comp<-comp %>% filter(COLD %in% c("A","D"))
comp$climate<-NA
comp$climate[comp$COLD=="D" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="A" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~COLD)
comp<-real.data %>% filter(Taxa %in% c("Cryptotaenia canadensis","Eurbia diviricata"))
comp<-real.data %>% filter(Taxa %in% c("Cryptotaenia canadensis","Eurbia diviricata"))
comp<-comp %>% filter(COLD %in% c("D","H"))
comp$climate<-NA
comp$climate[comp$COLD=="D" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="H" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~COLD)
comp$climate[comp$COLD=="H" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="H" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~COLD)
comp$climate<-NA
comp$climate[comp$COLD=="H" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="H" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~COLD)
comp<-real.data %>% filter(Taxa %in% c("Cryptotaenia canadensis","Eurbia diviricata"))
comp<-comp %>% filter(COLD %in% c("D","H"))
comp$climate<-NA
comp$climate[comp$COLD=="H" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="H" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~COLD)
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~climate)
comp<-real.data %>% filter(Taxa %in% c("Cryptotaenia canadensis","Eurbia diviricata"))
comp<-comp %>% filter(COLD %in% c("D","i"))
comp$climate<-NA
comp$climate[comp$COLD=="i" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="i" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~climate)
comp<-comp %>% filter(COLD %in% c("D","f"))
comp$climate<-NA
comp$climate[comp$COLD=="f" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="f" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~climate)
comp<-real.data %>% filter(Taxa %in% c("Cryptotaenia canadensis","Eurbia diviricata"))
comp<-comp %>% filter(COLD %in% c("D","f"))
comp$climate<-NA
comp$climate[comp$COLD=="f" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="f" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~climate)
comp<-real.data %>% filter(Taxa %in% c("Cryptotaenia canadensis","Eurbia diviricata"))
comp<-comp %>% filter(COLD %in% c("D","f"))
comp$climate<-NA
comp$climate[comp$COLD=="f" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="D" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~climate)
comp<-real.data %>% filter(Taxa %in% c("Cryptotaenia canadensis","Eurbia diviricata"))
comp<-comp %>% filter(COLD %in% c("C","f"))
comp$climate<-NA
comp$climate[comp$COLD=="f" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="C" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~climate)
comp<-comp %>% filter(COLD %in% c("B","f"))
comp$climate<-NA
comp$climate[comp$COLD=="f" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="B" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~climate)
comp<-real.data %>% filter(Taxa %in% c("Cryptotaenia canadensis","Eurbia diviricata"))
comp<-comp %>% filter(COLD %in% c("B","f"))
comp$climate<-NA
comp$climate[comp$COLD=="f" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="B" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~climate)
comp1<-filter(comp, climate=="cool")
comp1.asc<-filter(comp1,Taxa=="Cryptotaenia canadensis")
com1.sv<-filter(comp1,Taxa=="Eurbia diviricata")
mod.1<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=comp1.asc,type="continuous")
mod.2<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=com1.sv,type="continuous")
summary(mod.1)
comp2<-filter(comp, climate=="warm")
comp2.asc<-filter(comp2,Taxa=="Cryptotaenia canadensis")
com2.sv<-filter(comp2,Taxa=="Eurbia diviricata")
mod.3<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=comp2.asc,type="continuous")
mod.4<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=com2.sv,type="continuous")
par(mfrow=c(1,2))
par(mar=c(2,3,1.8,0.5))
plot(mod.1,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5, ylab="cumulative germination",main="cool conditions")
plot(mod.1, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.2,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.2, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
plot(mod.3,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5,ylab="",main="warm conditions")
plot(mod.3, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.4,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.4, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
mod.1<-drm(germ.cum~DAY,,fct=LL.3(c(NA,15,NA)),data=comp1.asc,type="continuous")
mod.2<-drm(germ.cum~DAY,,fct=LL.3(c(NA,15,NA)),data=com1.sv,type="continuous")
summary(mod.1)
comp2<-filter(comp, climate=="warm")
comp2.asc<-filter(comp2,Taxa=="Cryptotaenia canadensis")
com2.sv<-filter(comp2,Taxa=="Eurbia diviricata")
mod.3<-drm(germ.cum~DAY,,fct=LL.3(c(NA,10,NA)),data=comp2.asc,type="continuous")
mod.4<-drm(germ.cum~DAY,,fct=LL.3(c(NA,10,NA)),data=com2.sv,type="continuous")
par(mfrow=c(1,2))
par(mar=c(2,3,1.8,0.5))
plot(mod.1,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5, ylab="cumulative germination",main="cool conditions")
plot(mod.1, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.2,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.2, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
plot(mod.3,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5,ylab="",main="warm conditions")
plot(mod.3, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.4,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.4, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
par(mfrow=c(1,2))
par(mar=c(2,3,1.8,0.5))
plot(mod.1,ylim=c(0,20),xlim=c(0,35),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5, ylab="cumulative germination",main="cool conditions")
plot(mod.1, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.2,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.2, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
par(mfrow=c(1,2))
par(mar=c(2,3,1.8,0.5))
plot(mod.1,ylim=c(0,20),xlim=c(0,35),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5, ylab="cumulative germination",main="cool conditions")
plot(mod.1, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.2,ylim=c(0,20),xlim=c(0,35),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.2, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
plot(mod.3,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5,ylab="",main="warm conditions")
mod.1<-drm(germ.cum~DAY,,fct=LL.3(c(NA,10,NA)),data=comp1.asc,type="continuous")
mod.2<-drm(germ.cum~DAY,,fct=LL.3(c(NA,10,NA)),data=com1.sv,type="continuous")
summary(mod.1)
comp2<-filter(comp, climate=="warm")
comp2.asc<-filter(comp2,Taxa=="Cryptotaenia canadensis")
com2.sv<-filter(comp2,Taxa=="Eurbia diviricata")
mod.3<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=comp2.asc,type="continuous")
mod.4<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=com2.sv,type="continuous")
par(mfrow=c(1,2))
par(mar=c(2,3,1.8,0.5))
plot(mod.1,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5, ylab="cumulative germination",main="cool conditions")
plot(mod.1, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.2,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.2, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
plot(mod.3,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5,ylab="",main="warm conditions")
plot(mod.3, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
par(mfrow=c(1,2))
par(mar=c(2,3,1.8,0.5))
plot(mod.1,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5, ylab="cumulative germination",main="cool conditions")
plot(mod.1, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
mod.1<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=comp1.asc,type="continuous")
mod.2<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=com1.sv,type="continuous")
summary(mod.1)
comp2<-filter(comp, climate=="warm")
comp2.asc<-filter(comp2,Taxa=="Cryptotaenia canadensis")
com2.sv<-filter(comp2,Taxa=="Eurbia diviricata")
mod.3<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=comp2.asc,type="continuous")
mod.4<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=com2.sv,type="continuous")
par(mfrow=c(1,2))
par(mar=c(2,3,1.8,0.5))
plot(mod.1,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5, ylab="cumulative germination",main="cool conditions")
plot(mod.1, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.2,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.2, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
plot(mod.3,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5,ylab="",main="warm conditions")
plot(mod.3, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.4,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.4, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
par(mfrow=c(1,2))
par(mar=c(2,3,1.8,0.5))
plot(mod.1,ylim=c(0,20),xlim=c(0,40),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5, ylab="cumulative germination",main="cool conditions")
plot(mod.1, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.2,ylim=c(0,20),xlim=c(0,40),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.2, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
plot(mod.3,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5,ylab="",main="warm conditions")
plot(mod.3, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.4,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.4, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
par(mfrow=c(1,2))
par(mar=c(2,3,1.8,0.5))
plot(mod.1,ylim=c(0,20),xlim=c(0,40),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5, ylab="cumulative germination",main="cool conditions")
plot(mod.1, broken = TRUE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.2,ylim=c(0,20),xlim=c(0,40),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.2, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
plot(mod.3,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5,ylab="",main="warm conditions")
plot(mod.3, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.4,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.4, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
par(mfrow=c(1,2))
par(mar=c(2,3,1.8,0.5))
plot(mod.1,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5, ylab="cumulative germination",main="cool conditions")
plot(mod.1, broken = TRUE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.2,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.2, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
plot(mod.3,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5,ylab="",main="warm conditions")
plot(mod.3, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.4,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.4, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
comp<-real.data %>% filter(Taxa %in% c("Cryptotaenia canadensis","Eurbia diviricata"))
comp<-comp %>% filter(COLD %in% c("C","f"))
comp$climate<-NA
comp$climate[comp$COLD=="f" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="C" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~climate)
comp1<-filter(comp, climate=="cool")
comp1.asc<-filter(comp1,Taxa=="Cryptotaenia canadensis")
com1.sv<-filter(comp1,Taxa=="Eurbia diviricata")
mod.1<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=comp1.asc,type="continuous")
mod.2<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=com1.sv,type="continuous")
summary(mod.1)
comp2<-filter(comp, climate=="warm")
comp2.asc<-filter(comp2,Taxa=="Cryptotaenia canadensis")
com2.sv<-filter(comp2,Taxa=="Eurbia diviricata")
mod.3<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=comp2.asc,type="continuous")
mod.4<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=com2.sv,type="continuous")
par(mfrow=c(1,2))
par(mar=c(2,3,1.8,0.5))
plot(mod.1,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5, ylab="cumulative germination",main="cool conditions")
plot(mod.1, broken = TRUE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.2,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.2, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
plot(mod.3,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5,ylab="",main="warm conditions")
plot(mod.3, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.4,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.4, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
comp<-comp %>% filter(COLD %in% c("A","f"))
comp<-real.data %>% filter(Taxa %in% c("Cryptotaenia canadensis","Eurbia diviricata"))
comp<-comp %>% filter(COLD %in% c("A","f"))
comp$climate<-NA
comp$climate[comp$COLD=="f" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="A" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~climate)
comp1<-filter(comp, climate=="cool")
comp1.asc<-filter(comp1,Taxa=="Cryptotaenia canadensis")
com1.sv<-filter(comp1,Taxa=="Eurbia diviricata")
mod.1<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=comp1.asc,type="continuous")
mod.2<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=com1.sv,type="continuous")
summary(mod.1)
comp2<-filter(comp, climate=="warm")
comp2.asc<-filter(comp2,Taxa=="Cryptotaenia canadensis")
com2.sv<-filter(comp2,Taxa=="Eurbia diviricata")
mod.3<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=comp2.asc,type="continuous")
mod.4<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=com2.sv,type="continuous")
par(mfrow=c(1,2))
par(mar=c(2,3,1.8,0.5))
plot(mod.1,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5, ylab="cumulative germination",main="cool conditions")
plot(mod.1, broken = TRUE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.2,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.2, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
plot(mod.3,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5,ylab="",main="warm conditions")
plot(mod.3, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.4,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.4, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
comp<-comp %>% filter(COLD %in% c("B","f"))
comp$climate<-NA
comp$climate[comp$COLD=="f" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="B" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~climate)
comp1<-filter(comp, climate=="cool")
comp1.asc<-filter(comp1,Taxa=="Cryptotaenia canadensis")
comp<-real.data %>% filter(Taxa %in% c("Cryptotaenia canadensis","Eurbia diviricata"))
comp<-comp %>% filter(COLD %in% c("B","f"))
comp$climate<-NA
comp$climate[comp$COLD=="f" & comp$INC=="H"]<-"warm"
comp$climate[comp$COLD=="B" & comp$INC=="L"]<-"cool"
comp<-filter(comp,!is.na(climate))
ggplot(comp, aes(x = DAY, y = germ.cum, color=Taxa)) + stat_summary(alpha=0.7)+theme_bw()+geom_line(stat = "summary", fun.y = mean)+facet_wrap(~climate)
comp1<-filter(comp, climate=="cool")
comp1.asc<-filter(comp1,Taxa=="Cryptotaenia canadensis")
com1.sv<-filter(comp1,Taxa=="Eurbia diviricata")
mod.1<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=comp1.asc,type="continuous")
mod.2<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=com1.sv,type="continuous")
summary(mod.1)
comp2<-filter(comp, climate=="warm")
comp2.asc<-filter(comp2,Taxa=="Cryptotaenia canadensis")
com2.sv<-filter(comp2,Taxa=="Eurbia diviricata")
mod.3<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=comp2.asc,type="continuous")
mod.4<-drm(germ.cum~DAY,,fct=LL.3(c(NA,NA,NA)),data=com2.sv,type="continuous")
par(mfrow=c(1,2))
par(mar=c(2,3,1.8,0.5))
plot(mod.1,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5, ylab="cumulative germination",main="cool conditions")
plot(mod.1, broken = TRUE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.2,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.2, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
plot(mod.3,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="darkgreen",pch=20,cex=0.5,ylab="",main="warm conditions")
plot(mod.3, broken = FALSE, type="confidence", add=TRUE, col="darkgreen")
plot(mod.4,ylim=c(0,20),xlim=c(0,25),log="",type="all",legendPos = c(15,5),col="navyblue",pch=20,add=TRUE,cex=0.5)
plot(mod.4, broken = FALSE, type="confidence", add=TRUE,col="navyblue")
