scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())+scale_y_discrete()
#ggpubr::ggarrange(a,b,common.legend = TRUE,legend="right",widths=c(.6,.3),labels = c("a)","b)"))
ggplot(new.data,aes(x = chillweeks, color = Taxa))+
#geom_line(aes(y=.epred,group=paste(.draw,Taxa,incubation)),alpha=.05)+
stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa,group=paste(Taxa,incubation)))+
scale_color_viridis_d(begin=0,end=0.5)+ggthemes::theme_few()+
labs(y="Model Estimated Days to 50% Germination",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"),legend.position = "top")+
scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())+scale_y_discrete()
#ggpubr::ggarrange(a,b,common.legend = TRUE,legend="right",widths=c(.6,.3),labels = c("a)","b)"))
ggplot(new.data,aes(x = chillweeks, color = Taxa))+
geom_line(aes(y=.epred,group=paste(.draw,Taxa,incubation)),alpha=.05)+
#stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa,group=paste(Taxa,incubation)))+
scale_color_viridis_d(begin=0,end=0.5)+ggthemes::theme_few()+
labs(y="Model Estimated Days to 50% Germination",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"),legend.position = "top")+
scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())+scale_y_discrete()
#ggpubr::ggarrange(a,b,common.legend = TRUE,legend="right",widths=c(.6,.3),labels = c("a)","b)"))
ggplot(new.data,aes(x = chillweeks, color = Taxa))+
geom_line(aes(y=.epred,group=paste(.draw,Taxa,incubation)),alpha=.05)+
stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa,group=paste(Taxa,incubation)))+
scale_color_viridis_d(begin=0,end=0.5)+ggthemes::theme_few()+
labs(y="Model Estimated Days to 50% Germination",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"),legend.position = "top")+
scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())+scale_y_discrete()
View(new.data)
###a script to amke my data survival formated
###need to add a way to elminate seeds that rotted.
rm(list=ls())
options(stringsAsFactors = FALSE)
library(survival)
library(ggplot2)
library(dplyr)
library("ggfortify")
library("icenReg")
library("emmeans")
library(drc)
library(lme4)
library(brms)
library(ggstance)
library(tidybayes)
library(bayesplot)
setwd("~/Documents/git/timetogerminate/germination_trials/input")
load("survmodel.Rda")
yaya<-fit.wei.all%>%
spread_draws(r_Taxa[Taxa,condition])
yaya<-filter(yaya,condition=="chillweeks")
yaya$species<-NA
yaya$species[which(yaya$Taxa=="Thalictrum.dioicum")]<-"Thalictrum dioicum"
yaya$species[which(yaya$Taxa=="Silene.vulgaris")]<-"Silene vulgaris"
yaya$species[which(yaya$Taxa=="Silene.stellata")]<-"Silene stellata"
yaya$species[which(yaya$Taxa=="Polygonum.virginiatum")]<-"Persicaria virginiana"
yaya$species[which(yaya$Taxa=="Eurbia.diviricata")]<-"Eurybia divaricata"
yaya$species[which(yaya$Taxa=="Oenethera.biennis")]<-"Oenethera biennis"
yaya$species[which(yaya$Taxa=="Hesperis.matronalis")]<-"Hesperis matronalis"
yaya$species[which(yaya$Taxa=="Cryptotaenia.canadensis")]<-"Cryptotaenia canadensis"
yaya$species[which(yaya$Taxa=="Carex.grayi")]<-"Carex grayi"
yaya$species[which(yaya$Taxa=="Asclepias.syriaca")]<-"Asclepias syriaca"
yaya$species[which(yaya$Taxa=="Anemone.virginana")]<-"Anemone virginiana"
yaya2<-fit.wei.all%>%
spread_draws(b_chillweeks)
yaya$r_Taxa2<-yaya2$b_chillweeks+yaya$r_Taxa
yaya3<-fit.wei.all%>%
spread_draws(r_Taxa[Taxa,condition])
yaya3<-filter(yaya3,condition=="force")
yaya4<-fit.wei.all%>%
spread_draws(b_force)
yaya3$r_Taxa2<-yaya4$b_force+yaya3$r_Taxa
mu1<-ggplot()+ stat_eye(data=yaya,aes(r_Taxa2,species),fill="skyblue1",.width = c(.9))+ggthemes::theme_few()+geom_vline(xintercept=0)+
xlab("Estimated effect of cold stratification")+xlim(-.4,.25)+
theme(axis.title.y=element_blank(),
axis.text.y=element_text(face="italic"))+scale_y_discrete(limits=rev)
mu2<-ggplot()+ stat_eye(data=yaya3,aes(r_Taxa2,Taxa),fill="salmon",.width = c(.9))+ggthemes::theme_few()+geom_vline(xintercept=0)+
xlab("Estimated effect of incubation")+
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())+scale_y_discrete(limits=rev)
ggpubr::ggarrange(mu1,mu2,widths=c(.6,.4),labels = c("a)","b)"),hjust =c(-10, -1.5),vjust=2)
###########################
###### make plot 1############
pred.weeks<-c(5:16)
pred.force<-c(0)
new.data <- data.frame(Taxa=c("Cryptotaenia canadensis"),
chillweeks = c(rep(pred.weeks,12)), force = c(rep(pred.force,each=12)))
pred.weeks2<-c(10:16)
pred.force2<-c(5)
new.data2 <- data.frame(Taxa=c("Cryptotaenia canadensis"),
chillweeks = c(rep(pred.weeks2,7)), force = c(rep(pred.force2,each=7)))
pred.weeks3<-c(0:16)
pred.force3<-c(0,5)
new.data3 <- data.frame(Taxa=c(rep(c(unique(d$Taxa)),each=17)),
chillweeks = c(rep(pred.weeks3,11)), force = c(rep(pred.force3,each=187)))
library(tidybayes)
new.data<-new.data %>% add_epred_draws(fit.wei.in, ndraws = 200)
new.data2<-new.data2 %>% add_epred_draws(fit.wei.in, ndraws = 200)
new.data4<-filter(new.data3,Taxa=="Hesperis matronalis")
new.data4<-new.data4 %>% add_epred_draws(fit.wei.in, ndraws = 200)
new.data$incubation<-"25/15"
new.data2$incubation<-"20/10"
new.data4$incubation<-ifelse(new.data4$force==0,"20/10","25/15")
new.data<-rbind(new.data,new.data2,new.data4)
ggplot(new.data,aes(x = chillweeks, color = Taxa))+
geom_line(aes(y=.epred,group=paste(.draw,Taxa,incubation)),alpha=.05)+
stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa,group=paste(Taxa,incubation)))+
scale_color_viridis_d(begin=0,end=0.5)+ggthemes::theme_few()+
labs(y="Model Estimated Days to 50% Germination",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"),legend.position = "top")+
scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())
new.data3$incubation<-ifelse(new.data3$force==0,"20/10","25/15")
new.data3 %>% add_epred_draws(fit.wei.all, ndraws = 100) %>%
ggplot(aes(x = chillweeks, color = Taxa))+
scale_color_manual(values=c("#f0f921","#fdc527","#f89540","#440154","#e66c5c","#21918c","#cc4778","#aa2395","#7e03a8","#4c02a1", "#0d0887"))+
geom_line(aes(y=.epred,group=paste(.draw,Taxa)),alpha=.05)+
stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa))+
ggthemes::theme_few()+facet_wrap(~incubation)+
labs(y="",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"))
ggplot(daty4,aes(Estimate,Taxa))+geom_point(aes(shape=invasive,group=chillweeks,color=scenario),size=3.5)+
scale_shape_manual(values = c(15,16))+facet_grid(incubation~stratification,scales = "free")+
geom_errorbarh(aes(xmin=Q5,xmax=Q95),height=0)+
scale_color_viridis_c(option="turbo",direction = 1, begin=.2,end=.8)+
ggthemes::theme_few(base_size = 11)+
theme(axis.text.y = element_text(face = c("italic","italic","italic","italic","bold.italic","italic","italic","bold.italic"))
)+xlab("Day of Season")+ylab("")+xlim(0,20)+ guides(col = FALSE)
pred.weeks4<-c(6,12)
pred.force4<-c(0,5)
new.data4 <- data.frame(Taxa=c(rep(c(unique(d$Taxa)),each=2)),
chillweeks = c(rep(pred.weeks4,11)), force = c(rep(pred.force4,each=22)))
daty4<-fitted(fit.wei.all,probs =c(0.05,0.95),newdata=new.data4)### something is wrong with error
daty4<-cbind(daty4,new.data4)
daty4$incubation<-ifelse(daty4$force==0,"20/10","25/15")
daty4$stratification<-ifelse(daty4$chillweeks==6,"6 weeks","12 weeks")
daty4$invasive<-NA
daty4$invasive<-ifelse(new.data4$Taxa %in% c("Hesperis matronalis","Silene vulgaris"),"Invasive","Native")
daty4<-filter(daty4,!Taxa %in% c("Carex grayi","Thalictrum dioicum","Silene stellata"))
daty4$scenario<-NA
daty4$scenario[which(daty4$stratification=="12 weeks"& daty4$incubation=="20/10")]<-1
daty4$scenario[which(daty4$stratification=="12 weeks"& daty4$incubation=="25/15")]<-2
daty4$scenario[which(daty4$stratification=="6 weeks"& daty4$incubation=="25/15")]<-4
daty4$scenario[which(daty4$stratification=="6 weeks"& daty4$incubation=="20/10")]<-3
###clean species
daty4$Taxa[which(daty4$Taxa=="Eurbia diviricata")]<-"Eurybia divaricata"
daty4$Taxa[which(daty4$Taxa=="Polygonum virginiatum")]<-"Persicaria virginiana"
daty4$Taxa[which(daty4$Taxa=="Anemone virginana")]<-"Anemone virginiana"
ggplot(daty4,aes(Estimate,Taxa))+geom_point(aes(shape=invasive,group=chillweeks,color=scenario),size=3.5)+
scale_shape_manual(values = c(15,16))+facet_grid(incubation~stratification,scales = "free")+
geom_errorbarh(aes(xmin=Q5,xmax=Q95),height=0)+
scale_color_viridis_c(option="turbo",direction = 1, begin=.2,end=.8)+
ggthemes::theme_few(base_size = 11)+
theme(axis.text.y = element_text(face = c("italic","italic","italic","italic","bold.italic","italic","italic","bold.italic"))
)+xlab("Day of Season")+ylab("")+xlim(0,20)+ guides(col = FALSE)
daty4a<-dplyr::filter(daty4,scenario %in% c(1,4))
daty4a$scenario2<-ifelse(daty4a$scenario==1,"historic","warming")
cc<-ggplot(daty4a,aes(Estimate,Taxa))+geom_point(aes(shape=invasive,group=chillweeks,color=scenario2),size=3,alpha=0.75)+
scale_shape_manual(values = c(15,16))+
geom_errorbarh(aes(xmin=Q5,xmax=Q95,color=scenario2),height=0)+
scale_color_viridis_d(option="turbo",direction = 1, begin=.3,end=.95)+
ggthemes::theme_few(base_size = 11)+
theme(axis.text.y = element_text(face = c("bold.italic","italic","italic","bold.italic","italic","italic","italic","italic")))+
xlab("Day of season for 50% germination")+ylab("")+guides(scale = "none")+geom_vline(xintercept=20, linetype="dashed")+theme(legend.title=element_blank(),legend.position = "top")+
scale_y_discrete(limits=rev)
cc
#ggpubr::ggarrange(a,b,common.legend = TRUE,legend="right",widths=c(.6,.3),labels = c("a)","b)"))
ggplot(new.data,aes(x = chillweeks, color = Taxa))+
geom_line(aes(y=.epred,group=paste(.draw,Taxa,incubation)),alpha=.05)+
stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa,group=paste(Taxa,incubation)))+
scale_color_viridis_d(begin=0,end=0.5)+ggthemes::theme_few()+
labs(y="Model Estimated Days to 50% Germination",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"),legend.position = "top")+
scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())+scale_y_discrete()
ggplot(new.data,aes(x = chillweeks, color = Taxa))+
geom_line(aes(y=.epred,group=paste(.draw,Taxa,incubation)),alpha=.05)+
stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa,group=paste(Taxa,incubation)))+
scale_color_viridis_d(begin=0,end=0.5)+ggthemes::theme_few()+
labs(y="Model Estimated Days to 50% Germination",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"),legend.position = "top")+
scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())
new.data$Taxa<-ifelse(newdata$Taxa==" Cryptotaenia canadensis","Cryptotaenia canadensis /n(native)","Hesperis matronalis \n(invasive)")
new.data$Taxa<-ifelse(new.data$Taxa==" Cryptotaenia canadensis","Cryptotaenia canadensis /n(native)","Hesperis matronalis \n(invasive)")
ggplot(new.data,aes(x = chillweeks, color = Taxa))+
geom_line(aes(y=.epred,group=paste(.draw,Taxa,incubation)),alpha=.05)+
stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa,group=paste(Taxa,incubation)))+
scale_color_viridis_d(begin=0,end=0.5)+ggthemes::theme_few()+
labs(y="Model Estimated Days to 50% Germination",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"),legend.position = "top")+
scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())
###########################
###### make plot 1############
pred.weeks<-c(5:16)
pred.force<-c(0)
new.data <- data.frame(Taxa=c("Cryptotaenia canadensis"),
chillweeks = c(rep(pred.weeks,12)), force = c(rep(pred.force,each=12)))
pred.weeks2<-c(10:16)
pred.force2<-c(5)
new.data2 <- data.frame(Taxa=c("Cryptotaenia canadensis"),
chillweeks = c(rep(pred.weeks2,7)), force = c(rep(pred.force2,each=7)))
pred.weeks3<-c(0:16)
pred.force3<-c(0,5)
new.data3 <- data.frame(Taxa=c(rep(c(unique(d$Taxa)),each=17)),
chillweeks = c(rep(pred.weeks3,11)), force = c(rep(pred.force3,each=187)))
library(tidybayes)
new.data<-new.data %>% add_epred_draws(fit.wei.in, ndraws = 200)
new.data2<-new.data2 %>% add_epred_draws(fit.wei.in, ndraws = 200)
new.data4<-filter(new.data3,Taxa=="Hesperis matronalis")
new.data4<-new.data4 %>% add_epred_draws(fit.wei.in, ndraws = 200)
new.data$incubation<-"25/15"
new.data2$incubation<-"20/10"
new.data4$incubation<-ifelse(new.data4$force==0,"20/10","25/15")
new.data<-rbind(new.data,new.data2,new.data4)
new.data$Taxa2<-ifelse(new.data$Taxa==" Cryptotaenia canadensis","Cryptotaenia canadensis /n(native)","Hesperis matronalis \n(invasive)")
ggplot(new.data,aes(x = chillweeks, color = Taxa))+
geom_line(aes(y=.epred,group=paste(.draw,Taxa,incubation)),alpha=.05)+
stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa,group=paste(Taxa,incubation)))+
scale_color_viridis_d(begin=0,end=0.5)+ggthemes::theme_few()+
labs(y="Model Estimated Days to 50% Germination",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"),legend.position = "top")+
scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())
ggplot(new.data,aes(x = chillweeks, color = Taxa))+
geom_line(aes(y=.epred,group=paste(.draw,Taxa,incubation)),alpha=.05)+
stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa2,group=paste(Taxa,incubation)))+
scale_color_viridis_d(begin=0,end=0.5)+ggthemes::theme_few()+
labs(y="Model Estimated Days to 50% Germination",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"),legend.position = "top")+
scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())
new.data$Taxa2<-ifelse(new.data$Taxa=="Cryptotaenia canadensis","Cryptotaenia canadensis /n(native)","Hesperis matronalis \n(invasive)")
ggplot(new.data,aes(x = chillweeks, color = Taxa))+
geom_line(aes(y=.epred,group=paste(.draw,Taxa,incubation)),alpha=.05)+
stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa2,group=paste(Taxa,incubation)))+
scale_color_viridis_d(begin=0,end=0.5)+ggthemes::theme_few()+
labs(y="Model Estimated Days to 50% Germination",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"),legend.position = "top")+
scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())
new.data$Taxa2<-ifelse(new.data$Taxa=="Cryptotaenia canadensis","Cryptotaenia canadensis \n(native)","Hesperis matronalis \n(invasive)")
ggplot(new.data,aes(x = chillweeks, color = Taxa))+
geom_line(aes(y=.epred,group=paste(.draw,Taxa,incubation)),alpha=.05)+
stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa2,group=paste(Taxa,incubation)))+
scale_color_viridis_d(begin=0,end=0.5)+ggthemes::theme_few()+
labs(y="Model Estimated Days to 50% Germination",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"),legend.position = "top")+
scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())
ggplot(new.data,aes(x = chillweeks, color = Taxa))+
geom_line(aes(y=.epred,group=paste(.draw,Taxa2,incubation)),alpha=.05)+
stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa2,group=paste(Taxa,incubation)))+
scale_color_viridis_d(begin=0,end=0.5)+ggthemes::theme_few()+
labs(y="Model Estimated Days to 50% Germination",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"),legend.position = "top")+
scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())
ggplot(new.data,aes(x = chillweeks, color = Taxa2))+
geom_line(aes(y=.epred,group=paste(.draw,Taxa2,incubation)),alpha=.05)+
stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa2,group=paste(Taxa,incubation)))+
scale_color_viridis_d(begin=0,end=0.5)+ggthemes::theme_few()+
labs(y="Model Estimated Days to 50% Germination",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"),legend.position = "top")+
scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())
View(yaya)
jpeg("..//figures/AFTsivansive.jpeg",height=8,width=8, units="in",res=200)
ggplot(new.data,aes(x = chillweeks, color = Taxa2))+
geom_line(aes(y=.epred,group=paste(.draw,Taxa2,incubation)),alpha=.05)+
stat_summary(fun=mean, geom="line", size = .75,aes(y=.epred,color=Taxa2,group=paste(Taxa,incubation)))+
scale_color_viridis_d(begin=0,end=0.5)+ggthemes::theme_few()+
labs(y="Model Estimated Days to 50% Germination",x="Weeks of cold stratification")+theme(legend.text = element_text(face = "italic"),legend.position = "top")+
scale_x_continuous(breaks = c(0,2,4,6,8,10,12,14,16))+
scale_y_continuous(breaks = c(0,5,10,15,20,30,40,50))+theme(legend.title= element_blank())
dev.off()
###Clean data comes from generate_xside.R
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
options(mc.cores = parallel::detectCores())
setwd("~/Documents/git/seedpriorities/full_exp")
load("invasivemods.Rda")
ggplot(outputbetas,aes(y = beta, x = Estimate))+
stat_halfeye(aes(color=species,fill=species),alpha=0.6)+ggthemes::theme_few()+scale_fill_viridis_d(begin=0,end=0.5)+
scale_color_viridis_d(begin=0,end=0.5)+geom_vline(xintercept =1)+
scale_y_discrete(limits=c("beta_priority","beta"),labels=c("Competition with \npriority effect","Competition no \npriority effect"))
plot1
plot1<-ggplot(output,aes(y = var, x = Estimate)) +
stat_halfeye(aes(fill=winner),.width=c(.9),alpha=0.6)+ggthemes::theme_few()+
geom_vline(xintercept=0,linetype="dashed")+
scale_y_discrete(limits=c("b_priority","b_n_Cc","b_n_Hm"),labels=c("Priority effect", expression(paste("Influence ", italic(" C. canadensis"))),expression(paste("Influence", italic(" H. matronalis")))))+
scale_fill_viridis_d(begin=0,end=.5)+theme(legend.position = "none")+ylab("")+xlim(-0.6,0.6)+annotate("text",x=-.15,y=.5,label=expression(paste(italic("C. canadensis") ," favored")))+
annotate("text",x=.15,y=.5,label=expression(paste(italic("H. matronalis") ," favored")))+
annotate("segment", x = -0.6, xend = -0.3, y = .5, yend = .5,
arrow = arrow(ends = "first", length = unit(.2,"cm")))+
annotate("segment", x = 0.3, xend = 0.6, y = .5, yend = .5,
arrow = arrow(ends = "last", length = unit(.2,"cm")))
plot1
plot1<-ggplot(output,aes(y = var, x = Estimate)) +
stat_halfeye(aes(fill=winner),.width=c(.9),alpha=0.6)+ggthemes::theme_few()+
geom_vline(xintercept=0,linetype="dashed")+
scale_y_discrete(limits=c("b_priority","b_n_Cc","b_n_Hm"),labels=c("Priority effect", expression(paste("Influence ", italic(" C. canadensis"))),expression(paste("Influence", italic(" H. matronalis")))))+
scale_fill_viridis_d(begin=0,end=.5)+theme(legend.position = "none")+ylab("")+xlim(-0.6,0.6)+annotate("text",x=-.15,y=.5,label=expression(paste(italic("C. canadensis \n(native)") ," favored")))+
annotate("text",x=.15,y=.5,label=expression(paste(italic("H. matronalis \n(invasive)") ," favored")))+
annotate("segment", x = -0.6, xend = -0.3, y = .5, yend = .5,
arrow = arrow(ends = "first", length = unit(.2,"cm")))+
annotate("segment", x = 0.3, xend = 0.6, y = .5, yend = .5,
arrow = arrow(ends = "last", length = unit(.2,"cm")))
plot1
jpeg("..//figure/mu_plots.jpeg",width = 10,height=5, units="in",res=200)
plot1
dev.off()
plot1<-ggplot(output,aes(y = var, x = Estimate)) +
stat_halfeye(aes(fill=winner),.width=c(.9),alpha=0.6)+ggthemes::theme_few()+
geom_vline(xintercept=0,linetype="dashed")+
scale_y_discrete(limits=c("b_priority","b_n_Cc","b_n_Hm"),labels=c("Priority effect", expression(paste("Influence ", italic(" C. canadensis"))),expression(paste("Influence", italic(" H. matronalis")))))+
scale_fill_viridis_d(begin=0,end=.5)+theme(legend.position = "none")+ylab("")+xlim(-0.6,0.6)+annotate("text",x=-.15,y=.5,label=expression(paste(italic("C. canadensis (native)") ," favored")))+
annotate("text",x=.15,y=.5,label=expression(paste(italic("H. matronalis (invasive)") ," favored")))+
annotate("segment", x = -0.6, xend = -0.3, y = .5, yend = .5,
arrow = arrow(ends = "first", length = unit(.2,"cm")))+
annotate("segment", x = 0.3, xend = 0.6, y = .5, yend = .5,
arrow = arrow(ends = "last", length = unit(.2,"cm")))
jpeg("..//figure/mu_plots.jpeg",width = 10,height=5, units="in",res=200)
plot1
dev.off()
plot1<-ggplot(output,aes(y = var, x = Estimate)) +
stat_halfeye(aes(fill=winner),.width=c(.9),alpha=0.6)+ggthemes::theme_few()+
geom_vline(xintercept=0,linetype="dashed")+
scale_y_discrete(limits=c("b_priority","b_n_Cc","b_n_Hm"),labels=c("Priority effect", expression(paste("Influence ", italic(" C. canadensis"))),expression(paste("Influence", italic(" H. matronalis")))))+
scale_fill_viridis_d(begin=0,end=.5)+theme(legend.position = "none")+ylab("")+xlim(-0.6,0.6)+annotate("text",x=-.1,y=.5,label=expression(paste(italic("C. canadensis (native)") ," favored")))+
annotate("text",x=.1,y=.5,label=expression(paste(italic("H. matronalis (invasive)") ," favored")))+
annotate("segment", x = -0.6, xend = -0.3, y = .5, yend = .5,
arrow = arrow(ends = "first", length = unit(.2,"cm")))+
annotate("segment", x = 0.3, xend = 0.6, y = .5, yend = .5,
arrow = arrow(ends = "last", length = unit(.2,"cm")))
plot1
plot1<-ggplot(output,aes(y = var, x = Estimate)) +
stat_halfeye(aes(fill=winner),.width=c(.9),alpha=0.6)+ggthemes::theme_few()+
geom_vline(xintercept=0,linetype="dashed")+
scale_y_discrete(limits=c("b_priority","b_n_Cc","b_n_Hm"),labels=c("Priority effect", expression(paste("Influence ", italic(" C. canadensis"))),expression(paste("Influence", italic(" H. matronalis")))))+
scale_fill_viridis_d(begin=0,end=.5)+theme(legend.position = "none")+ylab("")+xlim(-0.6,0.6)+annotate("text",x=-.08,y=.5,label=expression(paste(italic("C. canadensis (native)") ," favored")))+
annotate("text",x=.08,y=.5,label=expression(paste(italic("H. matronalis (invasive)") ," favored")))+
annotate("segment", x = -0.6, xend = -0.3, y = .5, yend = .5,
arrow = arrow(ends = "first", length = unit(.2,"cm")))+
annotate("segment", x = 0.3, xend = 0.6, y = .5, yend = .5,
arrow = arrow(ends = "last", length = unit(.2,"cm")))
plot1
plot1<-ggplot(output,aes(y = var, x = Estimate)) +
stat_halfeye(aes(fill=winner),.width=c(.9),alpha=0.6)+ggthemes::theme_few()+
geom_vline(xintercept=0,linetype="dashed")+
scale_y_discrete(limits=c("b_priority","b_n_Cc","b_n_Hm"),labels=c("Priority effect", expression(paste("Influence ", italic(" C. canadensis"))),expression(paste("Influence", italic(" H. matronalis")))))+
scale_fill_viridis_d(begin=0,end=.5)+theme(legend.position = "none")+ylab("")+xlim(-0.6,0.6)+annotate("text",x=-.08,y=.5,label=expression(paste(italic("C. canadensis (native)") ," favored")))+
annotate("text",x=.08,y=.5,label=expression(paste(italic("H. matronalis (invasive)") ," favored")))+
annotate("segment", x = -0.6, xend = -0.5, y = .5, yend = .5,
arrow = arrow(ends = "first", length = unit(.2,"cm")))+
annotate("segment", x = 0.5, xend = 0.6, y = .5, yend = .5,
arrow = arrow(ends = "last", length = unit(.2,"cm")))
plot1
jpeg("..//figure/mu_plots.jpeg",width = 10,height=5, units="in",res=200)
plot1
dev.off()
plot1<-ggplot(output,aes(y = var, x = Estimate)) +
stat_halfeye(aes(fill=winner),.width=c(.9),alpha=0.6)+ggthemes::theme_few()+
geom_vline(xintercept=0,linetype="dashed")+
scale_y_discrete(limits=c("b_priority","b_n_Cc","b_n_Hm"),labels=c("Priority effect", expression(paste("Influence ", italic(" C. canadensis"))),expression(paste("Influence", italic(" H. matronalis")))))+
scale_fill_viridis_d(begin=0,end=.5)+theme(legend.position = "none")+ylab("")+xlim(-0.6,0.6)+annotate("text",x=-.4,y=.5,label=expression(paste(italic("C. canadensis (native)") ," favored")))+
annotate("text",x=.08,y=.5,label=expression(paste(italic("H. matronalis (invasive)") ," favored")))+
annotate("segment", x = -0.6, xend = -0.5, y = .5, yend = .5,
arrow = arrow(ends = "first", length = unit(.2,"cm")))+
annotate("segment", x = 0.5, xend = 0.6, y = .5, yend = .5,
arrow = arrow(ends = "last", length = unit(.2,"cm")))
plot1
plot1<-ggplot(output,aes(y = var, x = Estimate)) +
stat_halfeye(aes(fill=winner),.width=c(.9),alpha=0.6)+ggthemes::theme_few()+
geom_vline(xintercept=0,linetype="dashed")+
scale_y_discrete(limits=c("b_priority","b_n_Cc","b_n_Hm"),labels=c("Priority effect", expression(paste("Influence ", italic(" C. canadensis"))),expression(paste("Influence", italic(" H. matronalis")))))+
scale_fill_viridis_d(begin=0,end=.5)+theme(legend.position = "none")+ylab("")+xlim(-0.6,0.6)+annotate("text",x=-.3,y=.5,label=expression(paste(italic("C. canadensis (native)") ," favored")))+
annotate("text",x=.3,y=.5,label=expression(paste(italic("H. matronalis (invasive)") ," favored")))+
annotate("segment", x = -0.6, xend = -0.5, y = .5, yend = .5,
arrow = arrow(ends = "first", length = unit(.2,"cm")))+
annotate("segment", x = 0.5, xend = 0.6, y = .5, yend = .5,
arrow = arrow(ends = "last", length = unit(.2,"cm")))
plot1
jpeg("..//figure/mu_plots.jpeg",width = 10,height=5, units="in",res=200)
plot1
dev.off()
plot1<-ggplot(output,aes(y = var, x = Estimate)) +
stat_halfeye(aes(fill=winner),.width=c(.9),alpha=0.6)+ggthemes::theme_few()+
geom_vline(xintercept=0,linetype="dashed")+
scale_y_discrete(limits=c("b_priority","b_n_Cc","b_n_Hm"),labels=c("Priority effect", expression(paste("Influence ", italic(" C. canadensis"))),expression(paste("Influence", italic(" H. matronalis")))))+
scale_fill_viridis_d(begin=0,end=.5)+theme(legend.position = "none")+ylab("")+xlim(-0.6,0.6)+annotate("text",x=-.3,y=.5,label=expression(paste(italic("C. canadensis") ,"(native) favored")))+
annotate("text",x=.3,y=.5,label=expression(paste(italic("H. matronalis") ," (invasive) favored")))+
annotate("segment", x = -0.6, xend = -0.5, y = .5, yend = .5,
arrow = arrow(ends = "first", length = unit(.2,"cm")))+
annotate("segment", x = 0.5, xend = 0.6, y = .5, yend = .5,
arrow = arrow(ends = "last", length = unit(.2,"cm")))
plot1
jpeg("..//figure/mu_plots.jpeg",width = 10,height=5, units="in",res=200)
plot1
dev.off()
plot1<-ggplot(output,aes(y = var, x = Estimate)) +
stat_halfeye(aes(fill=winner),.width=c(.9),alpha=0.6)+ggthemes::theme_few()+
geom_vline(xintercept=0,linetype="dashed")+
scale_y_discrete(limits=c("b_priority","b_n_Cc","b_n_Hm"),labels=c("Priority effect", expression(paste("Influence ", italic(" C. canadensis"))),expression(paste("Influence", italic(" H. matronalis")))))+
scale_fill_viridis_d(begin=0,end=.5)+theme(legend.position = "none")+ylab("")+xlim(-0.6,0.6)+annotate("text",x=-.3,y=.5,label=expression(paste(italic("C. canadensis") ," (native) favored")))+
annotate("text",x=.3,y=.5,label=expression(paste(italic("H. matronalis") ," (invasive) favored")))+
annotate("segment", x = -0.6, xend = -0.5, y = .5, yend = .5,
arrow = arrow(ends = "first", length = unit(.2,"cm")))+
annotate("segment", x = 0.5, xend = 0.6, y = .5, yend = .5,
arrow = arrow(ends = "last", length = unit(.2,"cm")))
jpeg("..//figure/mu_plots.jpeg",width = 10,height=5, units="in",res=200)
plot1
dev.off()
ggplot(outputbetas,aes(y = beta, x = Estimate))+
stat_halfeye(aes(color=species,fill=species),alpha=0.6)+ggthemes::theme_few()+scale_fill_viridis_d(begin=0,end=0.5)+
scale_color_viridis_d(begin=0,end=0.5)+geom_vline(xintercept =1)+
scale_y_discrete(limits=c("beta_priority","beta"),labels=c("Competition with \npriority effect","Competition no \npriority effect"))
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
options(mc.cores = parallel::detectCores())
setwd("~/Documents/git/seedpriorities/full_exp")
library(dplyr,quietly = TRUE)
library(xtable,quietly=TRUE)
library(stringr)
library(lubridate)
library(ggplot2)
library(tidyr)
library(tidyselect)
library(reshape2)
library(brms)
d<-read.csv("full_data_sheet.csv")
table(d$taxa)
d<-filter(d,pot_type=="Cc.Hm")
sapply(d, class)
cols.num <- 14:40
d[cols.num] <- sapply(d[cols.num],as.numeric)
d<-d%>% pivot_longer(14:40,names_to="date",values_to = "count")
d<-dplyr::select(d,-date)
d2<-d%>% distinct()
#2<-d2 %>% tidyr::gather(date,count,14:40) depreciated
d2$count<-ifelse(is.na(d2$count),0,d2$count)
unique(d2$config)
d2$type<-ifelse(d2$config %in% c("monoA","monoB"),"single species","competition")
class(d2$strat)
d2$stratification<-ifelse(d2$strat==6,"low","high")
#niche<-brm(count~taxa*type*factstrat,data=d2, family=bernoulli(link=logit))
## Does competition reduce germination of C candensis
d3<-filter(d2,taxa=="C.canadensis")
niche<-brm(count~type*stratification,data=d3, family=bernoulli(link=logit))
brms::fixef(niche,probs=c(.25,.75))
c_eff<-conditional_effects(niche,"type:stratification",prob=0.9)
df <- as.data.frame(c_eff$"type:stratification")
pd=position_dodge(width=0.4)
df$type <- factor(df$type, levels = rev(levels(df$type)))
aplot<-ggplot(df,aes(stratification,estimate__))+geom_point(aes(shape=type),size=3,position=pd)+geom_errorbar(aes(ymin=lower__,ymax=upper__,group=type),position=pd,width=0)+
ggthemes::theme_few(base_size = 11)+ylab("Likelihood of Germination")+scale_color_viridis_d(option="turbo")+theme(legend.title = element_blank())
dat<-read.csv("data_4_invasive.csv")
dat$stratification<-ifelse(dat$strat==6,"low","high")
gruber<-brm(MGT_Cc~type*stratification,data=dat)
summary(gruber)
c_eff2<-conditional_effects(gruber,"type:stratification",prob=.9)
df2 <- as.data.frame(c_eff2$`type:stratification`)
df2$type <- factor(df2$type, levels = rev(levels(df2$type)))
bplot<-ggplot(df2,aes(stratification,estimate__))+geom_point(aes(shape=type),size=3,position=pd)+geom_errorbar(aes(ymin=lower__,ymax=upper__,group=type),width=0,position=pd)+
ggthemes::theme_few(base_size = 11)+ylab("Mean Germination Time")+scale_color_viridis_d(option="turbo")
dat.comp<-filter(dat, type=="competition")
compan<-brm(MGT_Cc~MGT_Hm*stratification,data=dat.comp)
c_eff3<-conditional_effects(compan,"MGT_Hm:stratification",prob=0.9)
c<-plot(c_eff3, plot = FALSE)[[1]]+scale_color_viridis_d(option="plasma",,begin = 0,end=.7)+
scale_fill_viridis_d(option="plasma",begin = 0,end=.7)+ggthemes::theme_few()+
ylab("MGT Honewort")+xlab("MGT Dames Rocket")+theme(legend.position="bottom")
fixef(compan)
plotaa<-ggpubr::ggarrange(aplot,bplot,common.legend=TRUE,labels =c( "a)","b)"))
ggpubr::ggarrange(plotaa,c,nrow=2,labels=c("","c)"))
plotaa
jpeg("..//figure/nichemodfication.jpeg",width = 4,height=4, units="in",res=200)
plotaa
dev.off()
View(dat.comp)
###prepare data for knb
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
options(mc.cores = parallel::detectCores())
setwd("~/Documents/git/seedpriorities/full_exp")
d<-read.csv("data_4_invasive.csv")
View(d)
colnames(d)
d<-select(d,-X,-sp)
d<-dplyr::select(d,-X,-sp)
View(d)
colnames(d)
d<-dplyr::select(d,-Cc_percap,-Hm_Percap,-priority2)
d<-dplyr::select(d,-Cc_percap,-Hm_percap,-priority2)
colnames(d)
write.csv(d,"comp_trials_knb.csv",row.names = FALSE)
###a script to amke my data survival formated
###need to add a way to elminate seeds that rotted.
rm(list=ls())
options(stringsAsFactors = FALSE)
library(survival)
library(ggplot2)
library(dplyr)
library("ggfortify")
library("icenReg")
library("emmeans")
library(drc)
library(lme4)
library(brms)
library(ggstance)
library(tidybayes)
library(bayesplot)
setwd("~/Documents/git/timetogerminate/germination_trials/input")
load("survmodel.Rda")
View(d.in)
colnames(d.in)
View(d.in)
d.knb<-dplyr::select(d.in,-"X",-"INC",-"COLD",-"date"-"warmT")
d.knb<-dplyr::select(d.in,-X,-INC,-COLD,-date,-warmT)
View(d.knb)
d.knb<-dplyr::select(d.in,-X,-INC,-COLD,-date,-warmT,-chill_time)
write.csv(d.knb,"germ_assays_knb.csv",row.names = FALSE)
