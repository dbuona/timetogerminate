plot(d$time,d$y,ylim=c(0,24))
plot(d$time,d$y,ylim=c(0,1))
mod<-drm(y~time,fct=LL.3(),data=d,type="continuous")
lines(d$time,predict(mod),lty=2,col="red",lwd=3)
summary(mod)
vals<-1:36
n    <- length(vals)
lhs  <- paste("a",    1:n,     sep="")
lhs
lhs  <- paste("a",    1:12,     sep="")
lhs
# Create a list of matrices
MyList <- list(A,B,C)
# Extract the 2nd column from `MyList` with the selection operator `[` with `lapply()`
(MyList,"[", , 2)
# Extract the 1st row from `MyList`
lapply(MyList,"[", 1, )
# Extract the 1st row from `MyList`
lapply(MyList,"[", 1, )
# Create a list of matrices
MyList <- list(A,B,C)
# Extract the 1st row from `MyList`
lapply(MyList,"[", 1, )
# Extract the 1st row from `MyList`
lapply(MyList,"[", 4, )
###fake data for germination mdodels
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(drc)
library(tidyverse)
library(MCMCglmm)
##use lognoral to simulate the data
set.seed(613613)
###This make data folowing the log logistic function
germ<-function(t,d,b,t50){
y<- d/(1+((t/t50)^b))
return(data.frame(time=t, y=y))
}
d<-replicate(germ(seq(0,24,by=3),rtnorm(1,.6,0.1,lower=0.4,upper=1),rnorm(1,-5,0.1),rnorm(1,15,1),3)
d<-replicate(germ(seq(0,24,by=3),rtnorm(1,.6,0.1,lower=0.4,upper=1),rnorm(1,-5,0.1),rnorm(1,15,1)),3)
d<-germ(seq(0,24,by=3),rtnorm(1,.6,0.1,lower=0.4,upper=1),rnorm(1,-5,0.1),rnorm(1,15,1))
replicate(d,3)
d<-replicate(germ(seq(0,24,by=3),rtnorm(1,.6,0.1,lower=0.4,upper=1),rnorm(1,-5,0.1),rnorm(1,15,1)),3)
d<-replicate(germ(seq(0,24,by=3),rtnorm(1,.6,0.1,lower=0.4,upper=1),rnorm(1,-5,0.1),rnorm(1,15,1)),4)
d<-germ(seq(0,24,by=3),rtnorm(1,.6,0.1,lower=0.4,upper=1),rnorm(1,-5,0.1),rnorm(1,15,1))
germ(seq(0,24,by=3),rtnorm(1,.6,0.1,lower=0.4,upper=1),rnorm(1,-5,0.1),rnorm(1,15,1))
A<-germ(seq(0,24,by=3),rtnorm(1,.6,0.1,lower=0.4,upper=1),rnorm(1,-5,0.1),rnorm(1,15,1))
A$dish<-"A"
B<-germ(seq(0,24,by=3),rtnorm(1,.6,0.1,lower=0.4,upper=1),rnorm(1,-5,0.1),rnorm(1,15,1))
B$dish<-"B"
C<-germ(seq(0,24,by=3),rtnorm(1,0.6,0.1,lower=0.4,upper=1),rnorm(1,-5,0.1),rnorm(1,15,1))
C$dish<-"C"
d<-rbind(A,B,C)
plot(d$time,d$y,ylim=c(0,1))
mod<-drm(y~time,fct=LL.3(),data=d,type="continuous")
lines(d$time,predict(mod),lty=2,col="red",lwd=3)
A<-germ(seq(0,24,by=3),rtnorm(1,.6,0.1,lower=0.4,upper=1),rnorm(1,-3,0.1),rnorm(1,15,1))
A$dish<-"A"
B<-germ(seq(0,24,by=3),rtnorm(1,.6,0.1,lower=0.4,upper=1),rnorm(1,-3,0.1),rnorm(1,15,1))
B$dish<-"B"
C<-germ(seq(0,24,by=3),rtnorm(1,0.6,0.1,lower=0.4,upper=1),rnorm(1,-3,0.1),rnorm(1,15,1))
C$dish<-"C"
d<-rbind(A,B,C)
plot(d$time,d$y,ylim=c(0,1))
A<-germ(seq(0,24,by=3),rtnorm(1,.6,0.1,lower=0.4,upper=1),rnorm(1,-10,0.1),rnorm(1,15,1))
A$dish<-"A"
B<-germ(seq(0,24,by=3),rtnorm(1,.6,0.1,lower=0.4,upper=1),rnorm(1,-10,0.1),rnorm(1,15,1))
B$dish<-"B"
C<-germ(seq(0,24,by=3),rtnorm(1,0.6,0.1,lower=0.4,upper=1),rnorm(1,-10,0.1),rnorm(1,15,1))
C$dish<-"C"
d<-rbind(A,B,C)
plot(d$time,d$y,ylim=c(0,1))
mod<-drm(y~time,fct=LL.3(),data=d,type="continuous")
lines(d$time,predict(mod),lty=2,col="red",lwd=3)
summary(mod)
plot(mod)
lines(d$time,mod,lty=2,col="red",lwd=3)
plot(d$time,d$y,ylim=c(0,1))
lines(mod)
lines(predict(mod))
lines(d$time,predict(mod))
plot(d$time,d$y,ylim=c(0,1))
lines(d$time,predict(mod))
plot(mod)
points(d$y,d$time)
points(d$time,d$y)
points(d$time,d$y,col="blue")
#make your data
d<-rbind(A,B,C)
mod<-drm(y~time,fct=LL.3(),data=d,type="continuous")
plot(mod)
points(d$time,d$y,col="blue")
plot(mod,ylim=c(0,1),xlim=c(0,24))
points(d$time,d$y,col="blue")
points(d$time,d$y,col="blue",pch=11)
plot(mod,ylim=c(0,1),xlim=c(0,24))
points(d$time,d$y,col="blue",pch=11)
points(d$time,d$y,col="blue",pch=9)
plot(mod,ylim=c(0,1),xlim=c(0,24))
points(d$time,d$y,col="blue",pch=9)
?pch
plot(mod,ylim=c(0,1),xlim=c(0,24))
points(d$time,d$y,col="blue",pch=16)
plot(mod,ylim=c(0,1),xlim=c(0,24),xtlab(seq(0:24,by=3))
plot(mod,ylim=c(0,1),xlim=c(0,24),xtlab(seq(0:24,by=3)))
plot(mod,ylim=c(0,1),xlim=c(0,24),xtlab(seq(0:24,by=3)))
drc::plot(mod,ylim=c(0,1),xlim=c(0,24),xtlab(seq(0:24,by=3)))
plot(mod,ylim=c(0,1),xlim=c(0,24),xtlab=seq(0:24,by=3)))
plot(mod,ylim=c(0,1),xlim=c(0,24),xtlab=seq(0:24,by=3))
plot(mod,ylim=c(0,1),xlim=c(0,24),xtlab=1:24)
plot(mod,ylim=c(0,1),xlim=c(0,24),broken=FALSE)
plot(mod,ylim=c(0,1),xlim=c(0,24),broken=TRUE)
plot(mod,ylim=c(0,1),xlim=c(0,24))
plot(mod,ylim=c(0,1),xlim=c(0,24),xttrim=FALSE)
plot(mod,ylim=c(0,1),xlim=c(0,24),xtsty="standard")
plot(mod,ylim=c(0,1),xlim=c(0,24),log="")
points(d$time,d$y,col="blue",pch=16)
plot(mod,ylim=c(0,1),xlim=c(0,24),log="")
plot(mod,ylim=c(0,1),xlim=c(0,24),log="",pch=16,type="none")
plot(mod,ylim=c(0,1),xlim=c(0,24),log="",pch=16,type="obs")
plot(mod,ylim=c(0,1),xlim=c(0,24),log="",pch=16,type=c("obs","none"))
plot(mod,ylim=c(0,1),xlim=c(0,24),log="",pch=16,type="all")
##Ask Lizzie about the chilling.
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(dplyr)
library(brms)
setwd("~/Documents/git/proterant/FLOBUDS")
db.dat<-read.csv("input/xfirst.event.dat.csv")
df.dat<-read.csv("input/Budburst By Day.csv")
###compare_periodicity begun by Dan B. on Feb 7 2019
#The goal of this file is to compare the effect of covarying photoperiodicity and thermoperiodcity by comparing dany flynn to Dan b's budburst experients
##Ask Lizzie about the chilling.
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(dplyr)
library(brms)
setwd("~/Documents/git/proterant/FLOBUDS")
db.dat<-read.csv("input/xfirst.event.dat.csv")
df.dat<-read.csv("input/Budburst By Day.csv")
df.dat.HF<-filter(df.dat,site=="HF") ##filter to only HF species
n <- 4
df.dat.HF$GEN.SPA<-paste(substr(df.dat.HF$sp, 1, n-1), ".", substr(df.dat.HF$sp, n, nchar(df.dat.HF$sp)), sep = "") ## make a column for GEN.SA
df.dat.HF<-filter(df.dat.HF,chill=="chill0")### select only DF's no chill treatment assume there was field chillint
unique(db.dat$GEN.SPA)
unique(df.dat.HF$GEN.SPA)
matching_sps<-intersect(unique(df.dat.HF$GEN.SPA),unique(db.dat$GEN.SPA)) ## could also add viburnum and vaccinium at the genus level
df.dat.match<-df.dat.HF %>%filter(GEN.SPA %in% c(matching_sps))
db.dat<-db.dat %>%filter(GEN.SPA %in% c(matching_sps))
db.dat$photoperiod<-ifelse(db.dat$Light=="L",12,8)
db.dat$temp_day<-ifelse(db.dat$Force=="W",24,18)
db.dat$temp_night<-ifelse(db.dat$Force=="W",18,12)
db.dat$chilldays<-ifelse(db.dat$Chill==0,28,56)
db.dat.match<-filter(db.dat,Chill==0) ### select only DAn B's low chilling (28days)
db.dat.match$FORCE<-ifelse(db.dat.match$temp_day==24,1,0) ### new column where forcing temperature are binary low or high
df.dat.match$FORCE<-ifelse(df.dat.match$warm==20,1,0)
db.dat.match$study<-"DB"
df.dat.match$study<-"DF"
##subset to columns of use
db.dat.match<-dplyr::select(db.dat.match,GEN.SPA,flo_day,Lbb_day,leaf_day,treatcode,temp_day,photoperiod,Chill,study,FORCE)
df.dat.match<-dplyr::select(df.dat.match,GEN.SPA,fday,bday,lday,treatcode,warm,photo,chill,study,FORCE)
###make columns the same
colnames(db.dat.match)[colnames(db.dat.match)=="flo_day" ] <- "fday"
colnames(db.dat.match)[colnames(db.dat.match)=="leaf_day" ] <- "lday"
colnames(db.dat.match)[colnames(db.dat.match)=="Lbb_day" ] <- "bday"
colnames(db.dat.match)[colnames(db.dat.match)=="temp_day" ] <- "warm"
colnames(db.dat.match)[colnames(db.dat.match)=="photoperiod" ] <- "photo"
colnames(db.dat.match)[colnames(db.dat.match)=="Chill" ] <- "chill"
colnames(db.dat.match)
colnames(df.dat.match)
both.dat<-rbind(df.dat.match,db.dat.match)
View(both.dat)
both.mod2<-brm(bday~photo+study+study:photo+(1|GEN.SPA),data=both.dat.sameforce)
both.dat.sameforce<-both.dat %>% filter(warm %in% c(20,18)) # This make a daya sheet where the average forcing in both experiments was 15 C (DB low, DF high)
both.dat.sameforce<-both.dat %>% filter(warm %in% c(20,18)) # This make a daya sheet where the average forcing in both experiments was 15 C (DB low, DF high)
both.mod2<-brm(bday~photo+study+study:photo+(1|GEN.SPA),data=both.dat.sameforce)
sumamry(both.mod2)
summary(both.mod2)
both.dat$PHOTO<-ifelse(both.dat$photo==8,0,1)
both.mod<-brm(bday~FORCE+PHOTO+study+study:PHOTO+study:FORCE+(1|GEN.SPA),data=both.dat)
coef(both.mod)
summary(both.mod)
both.dat.sameforce<-both.dat %>% filter(warm %in% c(20,18)) # This make a daya sheet where the average forcing in both experiments was 15 C (DB low, DF high)
both.mod2<-brm(bday~PHOTO*study+(1|GEN.SPA),data=both.dat.sameforce)
summary(both.mod2)
both.mod2<-brm(lday~PHOTO*study+(1|GEN.SPA),data=both.dat.sameforce)
summary(both.mod2)
###compare_periodicity begun by Dan B. on Feb 7 2019
#The goal of this file is to compare the effect of covarying photoperiodicity and thermoperiodcity by comparing dany flynn to Dan b's budburst experients
##Ask Lizzie about the chilling.
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(dplyr)
library(brms)
setwd("~/Documents/git/proterant/FLOBUDS")
db.dat<-read.csv("input/xfirst.event.dat.csv")
df.dat<-read.csv("input/Budburst By Day.csv")
df.dat.HF<-filter(df.dat,site=="HF") ##filter to only HF species
n <- 4
df.dat.HF$GEN.SPA<-paste(substr(df.dat.HF$sp, 1, n-1), ".", substr(df.dat.HF$sp, n, nchar(df.dat.HF$sp)), sep = "") ## make a column for GEN.SA
df.dat.HF<-filter(df.dat.HF,chill=="chill0")### select only DF's no chill treatment assume there was field chillint
unique(db.dat$GEN.SPA)
unique(df.dat.HF$GEN.SPA)
matching_sps<-intersect(unique(df.dat.HF$GEN.SPA),unique(db.dat$GEN.SPA)) ## could also add viburnum and vaccinium at the genus level
df.dat.match<-df.dat.HF %>%filter(GEN.SPA %in% c(matching_sps))  ### make both dataset noly consiston matching sps
db.dat<-db.dat %>%filter(GEN.SPA %in% c(matching_sps))
db.dat$photoperiod<-ifelse(db.dat$Light=="L",12,8)
db.dat$temp_day<-ifelse(db.dat$Force=="W",24,18)
db.dat$temp_night<-ifelse(db.dat$Force=="W",18,12)
db.dat$chilldays<-ifelse(db.dat$Chill==0,28,56)
### select only DAn B's low chilling (28days)
### Dan Flynn Temps  20/10 (15) and 15/5  (10)
##Dan B's Temps: 24/18 (21) and 18/12 (15)
##Dan B and Dan F photoperiods 12hours and 8 hours. Dan F covaried theromo anf photoperiodicity, Dan B did not.
###Chilling. Dan Flyyn's "Chill 2" was 4 degrees according to paper 33 days at 4c
##Dan Flynn's chilling periods were 0, 30d and 45d, Dan B's were 28d, and 56d. Acutally I think chill 2 was 4 degrees at
#ubset DF's data to be similar to DB's
db.dat.match$FORCE<-ifelse(db.dat.match$temp_day==24,1,0) ### new column where forcing temperature are binary low or high
df.dat.match$FORCE<-ifelse(df.dat.match$warm==20,1,0)
db.dat.match$study<-"DB"
df.dat.match$study<-"DF"
##subset to columns of use
db.dat.match<-dplyr::select(db.dat.match,GEN.SPA,flo_day,Lbb_day,leaf_day,treatcode,temp_day,photoperiod,Chill,study,FORCE)
df.dat.match<-dplyr::select(df.dat.match,GEN.SPA,fday,bday,lday,treatcode,warm,photo,chill,study,FORCE)
###make columns the same
colnames(db.dat.match)[colnames(db.dat.match)=="flo_day" ] <- "fday"
colnames(db.dat.match)[colnames(db.dat.match)=="leaf_day" ] <- "lday"
colnames(db.dat.match)[colnames(db.dat.match)=="Lbb_day" ] <- "bday"
colnames(db.dat.match)[colnames(db.dat.match)=="temp_day" ] <- "warm"
colnames(db.dat.match)[colnames(db.dat.match)=="photoperiod" ] <- "photo"
colnames(db.dat.match)[colnames(db.dat.match)=="Chill" ] <- "chill"
colnames(db.dat.match)
colnames(df.dat.match)
###compare_periodicity begun by Dan B. on Feb 7 2019
#The goal of this file is to compare the effect of covarying photoperiodicity and thermoperiodcity by comparing dany flynn to Dan b's budburst experients
##Ask Lizzie about the chilling.
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(dplyr)
library(brms)
setwd("~/Documents/git/proterant/FLOBUDS")
db.dat<-read.csv("input/xfirst.event.dat.csv")
df.dat<-read.csv("input/Budburst By Day.csv")
df.dat.HF<-filter(df.dat,site=="HF") ##filter to only HF species
n <- 4
df.dat.HF$GEN.SPA<-paste(substr(df.dat.HF$sp, 1, n-1), ".", substr(df.dat.HF$sp, n, nchar(df.dat.HF$sp)), sep = "") ## make a column for GEN.SA
df.dat.HF<-filter(df.dat.HF,chill=="chill0")### select only DF's no chill treatment assume there was field chillint
db.dat$photoperiod<-ifelse(db.dat$Light=="L",12,8)
db.dat$temp_day<-ifelse(db.dat$Force=="W",24,18)
db.dat$temp_night<-ifelse(db.dat$Force=="W",18,12)
db.dat$chilldays<-ifelse(db.dat$Chill==0,28,56)
unique(db.dat$GEN.SPA)
unique(df.dat.HF$GEN.SPA)
matching_sps<-intersect(unique(df.dat.HF$GEN.SPA),unique(db.dat$GEN.SPA)) ## could also add viburnum and vaccinium at the genus level
df.dat.match<-df.dat.HF %>%filter(GEN.SPA %in% c(matching_sps))  ### make both dataset noly consiston matching sps
db.dat.match<-db.dat %>%filter(GEN.SPA %in% c(matching_sps))
db.dat.match$FORCE<-ifelse(db.dat.match$temp_day==24,1,0) ### new column where forcing temperature are binary low or high
df.dat.match$FORCE<-ifelse(df.dat.match$warm==20,1,0)
db.dat.match$study<-"DB"
df.dat.match$study<-"DF"
##subset to columns of use
db.dat.match<-dplyr::select(db.dat.match,GEN.SPA,flo_day,Lbb_day,leaf_day,treatcode,temp_day,photoperiod,Chill,study,FORCE)
df.dat.match<-dplyr::select(df.dat.match,GEN.SPA,fday,bday,lday,treatcode,warm,photo,chill,study,FORCE)
###make columns the same
colnames(db.dat.match)[colnames(db.dat.match)=="flo_day" ] <- "fday"
colnames(db.dat.match)[colnames(db.dat.match)=="leaf_day" ] <- "lday"
colnames(db.dat.match)[colnames(db.dat.match)=="Lbb_day" ] <- "bday"
colnames(db.dat.match)[colnames(db.dat.match)=="temp_day" ] <- "warm"
colnames(db.dat.match)[colnames(db.dat.match)=="photoperiod" ] <- "photo"
colnames(db.dat.match)[colnames(db.dat.match)=="Chill" ] <- "chill"
colnames(db.dat.match)
colnames(df.dat.match)
unique(db.dat.match$chill)
db.dat.match.short<-filter(db.dat.match,chill==0)
db.dat.match.long<-filter(db.dat.match,chill==1)
db.dat.match.short<-filter(db.dat.match,chill==0)
db.dat.match.long<-filter(db.dat.match,chill==1)
both.dat1<-rbind(df.dat.match,db.dat.match.short) ###This is a datasheet
both.dat2<-rbind(df.dat.match,db.dat.match.long)
both.dat1$PHOTO<-ifelse(both.dat1$photo==8,0,1)
both.dat2$PHOTO<-ifelse(both.dat2$photo==8,0,1)
both.mod<-brm(bday~FORCE+PHOTO+study+study:PHOTO+study:FORCE+(1|GEN.SPA),data=both.dat2)
summary(both.mod)
summary(both.mod)
both.mod.leafout<-brm(lday~FORCE+PHOTO+study+study:PHOTO+study:FORCE+(1|GEN.SPA),data=both.dat2)
sumamry(both.mod.leafout)
summary(both.mod.leafout)
both.dat.sameforce<-both.dat.2 %>% filter(warm %in% c(20,18)) # This make a daya sheet where the average forcing in both experiments was 15 C (DB low, DF high)
both.dat.sameforce2<-both.dat2 %>% filter(warm %in% c(20,18)) # This make a daya sheet where the average forcing in both experiments was 15 C (DB low, DF high)
both.mod2<-brm(lday~PHOTO*study+(1|GEN.SPA),data=both.dat.sameforce2)
summary(both.mod2)
both.mod.leafout2<-both.mod.leafout
summary(both.mod.leafout2)
both.mod.bud2<-both.mod2
summary(both.mod.bud2)
summary(both.mod.bud2)
both.mod.bud2<-brm(bday~FORCE+PHOTO+study+study:PHOTO+study:FORCE+(1|GEN.SPA),data=both.dat2)
coef(both.mod.bud2)
summary(both.mod.bud2)
both.mod.bud2<-brm(bday~warm+PHOTO+study+study:PHOTO+study:warm+(1|GEN.SPA),data=both.dat2)
summary(both.mod.bud2)
summary(both.mod.leafout2)
both.mod.leafout2<-brm(lday~warm+PHOTO+study+study:PHOTO+study:warm+(1|GEN.SPA),data=both.dat2)
summary(both.mod.leafout2)
summary(both.mod.bud2)
both.mod.flow2<-brm(fday~warm+PHOTO+study+study:PHOTO+study:warm+(1|GEN.SPA),data=both.dat2)
summary(both.mod.flow2)
both.dat.sameforce2<-both.dat2 %>% filter(warm %in% c(20,18)) # This make a daya sheet where the average forcing in both experiments was 15 C (DB low, DF high)
pht.only.bb<-brm(bday~PHOTO*study+(PHOTO*study|GEN.SPA),data=both.dat.sameforce2)
summary(pht.only.bb)
coef(pht.only.bb)
both.mod.bud2.int<-brm(bday~warm+PHOTO+study+study:PHOTO+study:warm+(warm+PHOTO+study+study:PHOTO+study:warm|GEN.SPA),data=both.dat2)
coef(both.mod.bud2)
coef(both.mod.bud2.int)
both.mod.bud1<-brm(bday~warm+PHOTO+study+study:PHOTO+study:warm+(1|GEN.SPA),data=both.dat1)
summary(both.mod.bud1)
both.mod.bud1<-brm(bday~FORCE+PHOTO+study+study:PHOTO+study:FORCE+(1|GEN.SPA),data=both.dat1)
summary(both.mod.bud1)
both.mod.bud2<-brm(bday~FORCE+PHOTO+study+study:PHOTO+study:FORCE+(1|GEN.SPA),data=both.dat2)
summary(both.mod.bud2)
summary(both.mod.bud1)
summary(both.mod.bud2)
coef(both.mod.bud2.int)
summary(both.mod.bud2.int)
both.mod.bud2.int<-brm(bday~FORCE+PHOTO+study+study:PHOTO+study:FORCE+(FORCE+PHOTO+study+study:PHOTO+study:FORCE|GEN.SPA),data=both.dat2)
summary(both.mod.bud2.int)
summary(both.mod.bud2.int)
summary(both.mod.bud1)
coef(both.mod.bud2)
coef(both.mod.bud2.int)
summary(pht.only.bb)
coef(pht.only.bb)
pht.only.bb<-brm(bday~PHOTO*study+(study*PHOTO|GEN.SPA),data=both.dat.sameforce2,inter=3000,warmup=2000)
pht.only.bb<-brm(bday~PHOTO*study+(study*PHOTO|GEN.SPA),data=both.dat.sameforce2,iter=3000,warmup=2000)
summary(pht.only.bb)
both.dat.sameforce1<-both.dat1 %>% filter(warm %in% c(20,18))
pht.only.bb1<-brm(bday~PHOTO*study+(study*PHOTO|GEN.SPA),data=both.dat.sameforce1,iter=3000,warmup=2000)
coef(phyt.only.bb1)
coef(pht.only.bb1)
pht.only.bb1<-brm(bday~study*PHOTO+(study*PHOTO|GEN.SPA),data=both.dat.sameforce1,iter=3000,warmup=2000)
coef(pht.only.bb1)
View(df.dat.match)
View(db.dat.match)
db.dat<-read.csv("first.event.dat.csv")
##Ask Lizzie about the chilling.
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(dplyr)
library(brms)
setwd("~/Documents/git/proterant/FLOBUDS")
db.dat<-read.csv("first.event.dat.csv")
df.dat<-read.csv("input/Budburst By Day.csv")
df.dat.HF<-filter(df.dat,site=="HF") ##filter to only HF species
n <- 4
df.dat.HF$GEN.SPA<-paste(substr(df.dat.HF$sp, 1, n-1), ".", substr(df.dat.HF$sp, n, nchar(df.dat.HF$sp)), sep = "") ## make a column for GEN.SA
df.dat.HF<-filter(df.dat.HF,chill=="chill0")### select only DF's no chill treatment assume there was field chillint
db.dat$photoperiod<-ifelse(db.dat$Light=="L",12,8)
db.dat$temp_day<-ifelse(db.dat$Force=="W",24,18)
db.dat$temp_night<-ifelse(db.dat$Force=="W",18,12)
db.dat$chilldays<-ifelse(db.dat$Chill==0,28,56)
unique(db.dat$GEN.SPA)
unique(df.dat.HF$GEN.SPA)
matching_sps<-intersect(unique(df.dat.HF$GEN.SPA),unique(db.dat$GEN.SPA)) ## could also add viburnum and vaccinium at the genus level
df.dat.match<-df.dat.HF %>%filter(GEN.SPA %in% c(matching_sps))  ### make both dataset noly consiston matching sps
db.dat.match<-db.dat %>%filter(GEN.SPA %in% c(matching_sps))
db.dat.match$FORCE<-ifelse(db.dat.match$temp_day==24,1,0) ### new column where forcing temperature are binary low or high
df.dat.match$FORCE<-ifelse(df.dat.match$warm==20,1,0)
db.dat.match$study<-"DB"
df.dat.match$study<-"DF"
##subset to columns of use
db.dat.match<-dplyr::select(db.dat.match,GEN.SPA,flo_day,Lbb_day,leaf_day,treatcode,temp_day,photoperiod,Chill,study,FORCE)
df.dat.match<-dplyr::select(df.dat.match,GEN.SPA,fday,bday,lday,treatcode,warm,photo,chill,study,FORCE)
##Ask Lizzie about the chilling.
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(dplyr)
library(brms)
setwd("~/Documents/git/proterant/FLOBUDS")
db.dat<-read.csv("first.event.dat.csv")
df.dat<-read.csv("input/Budburst By Day.csv")
df.dat.HF<-filter(df.dat,site=="HF") ##filter to only HF species
n <- 4
df.dat.HF$GEN.SPA<-paste(substr(df.dat.HF$sp, 1, n-1), ".", substr(df.dat.HF$sp, n, nchar(df.dat.HF$sp)), sep = "") ## make a column for GEN.SA
df.dat.HF<-filter(df.dat.HF,chill=="chill0")### select only DF's no chill treatment assume there was field chillint
db.dat$photoperiod<-ifelse(db.dat$Light=="L",12,8)
db.dat$temp_day<-ifelse(db.dat$Force=="W",24,18)
db.dat$temp_night<-ifelse(db.dat$Force=="W",18,12)
db.dat$chilldays<-ifelse(db.dat$Chill==0,28,56)
unique(db.dat$GEN.SPA)
unique(df.dat.HF$GEN.SPA)
matching_sps<-intersect(unique(df.dat.HF$GEN.SPA),unique(db.dat$GEN.SPA)) ## could also add viburnum and vaccinium at the genus level
matching_sps
df.dat.match<-df.dat.HF %>%filter(GEN.SPA %in% c(matching_sps))  ### make both dataset noly consiston matching sps
db.dat.match<-db.dat %>%filter(GEN.SPA %in% c(matching_sps))
db.dat.match$FORCE<-ifelse(db.dat.match$temp_day==24,1,0) ### new column where forcing temperature are binary low or high
df.dat.match$FORCE<-ifelse(df.dat.match$warm==20,1,0)
db.dat.match$study<-"DB"
df.dat.match$study<-"DF"
##subset to columns of use
db.dat.match<-dplyr::select(db.dat.match,GEN.SPA,flo_day,Lbb_day,leaf_day,treatcode,temp_day,photoperiod,Chill,study,FORCE)
View(db.dat.match)
##subset to columns of use
db.dat.match<-dplyr::select(db.dat.match,GEN.SPA,flo_day.60.,Lbb_day.9.,leaf_day.15,treatcode,temp_day,photoperiod,Chill,study,FORCE)
##subset to columns of use
db.dat.match<-dplyr::select(db.dat.match,GEN.SPA,flo_day.60.,Lbb_day.9.,leaf_day.15.,treatcode,temp_day,photoperiod,Chill,study,FORCE)
df.dat.match<-dplyr::select(df.dat.match,GEN.SPA,fday,bday,lday,treatcode,warm,photo,chill,study,FORCE)
###make columns the same
colnames(db.dat.match)[colnames(db.dat.match)=="flo_day.60." ] <- "fday"
colnames(db.dat.match)[colnames(db.dat.match)=="leaf_day.15." ] <- "lday"
colnames(db.dat.match)[colnames(db.dat.match)=="Lbb_day.9." ] <- "bday"
colnames(db.dat.match)[colnames(db.dat.match)=="temp_day" ] <- "warm"
colnames(db.dat.match)[colnames(db.dat.match)=="photoperiod" ] <- "photo"
colnames(db.dat.match)[colnames(db.dat.match)=="Chill" ] <- "chill"
colnames(db.dat.match)
colnames(df.dat.match)
unique(db.dat.match$chill)
db.dat.match.short<-filter(db.dat.match,chill==0)
db.dat.match.long<-filter(db.dat.match,chill==1)
both.dat1<-rbind(df.dat.match,db.dat.match.short) ###This is a datasheet
both.dat2<-rbind(df.dat.match,db.dat.match.long)
both.dat1$PHOTO<-ifelse(both.dat1$photo==8,0,1)
both.dat2$PHOTO<-ifelse(both.dat2$photo==8,0,1)
both.mod.bud1<-brm(bday~FORCE+PHOTO+study+study:PHOTO+study:FORCE+(1|GEN.SPA),data=both.dat1)
summary(both.mod.bud1)
both.mod.bud1<-brm(bday~study+FORCE+PHOTO+study:PHOTO+study:FORCE+(1|GEN.SPA),data=both.dat1)
summary(both.mod.bud1)
both.mod.bud1<-brm(bday~study+FORCE+PHOTO+study:FORCE+study:PHOTO+(1|GEN.SPA),data=both.dat1)
summary(both.mod.bud1)
both.mod.bud2<-brm(bday~study+FORCE+PHOTO+study:FORCE+study:PHOTO+(1|GEN.SPA),data=both.dat2)
coef(both.mod.bud2)
summary(both.mod.bud2)
both.mod.leaf1<-brm(lday~study+FORCE+PHOTO+study:FORCE+study:PHOTO+(1|GEN.SPA),data=both.dat1)
coef(both.mod.bud2)
summary(both.mod.leaf1)
summary(both.mod.bud1)
summary(both.mod.leaf1)
summary(both.mod.bud2)
both.mod.leaf2<-brm(lday~study+FORCE+PHOTO+study:FORCE:study:PHOTO+(1|GEN.SPA),data=both.dat2)
sumamry(both.mod.leaf2)
summary(both.mod.leaf2)
summary(both.mod.leaf2)
both.mod.leaf2<-brm(lday~study+FORCE+PHOTO+study:FORCE+study:PHOTO+(1|GEN.SPA),data=both.dat2)
summary(both.mod.leaf2)
both.mod.bud1.int<-brm(bday~study+FORCE+PHOTO+study:FORCE+study:PHOTO+(bday~study+FORCE+PHOTO+study:FORCE+study:PHOTO|GEN.SPA),data=both.dat1)
summary(both.mod.bud1.int)
summary(both.mod.bud1.int)
both.mod.bud1.int<-brm(lday~study+FORCE+PHOTO+study:FORCE+study:PHOTO+(bday~study+FORCE+PHOTO+study:FORCE+study:PHOTO|GEN.SPA),data=both.dat1)
summary(both.mod.leaf1.int)
both.mod.bud1.int<-brm(bday~study+FORCE+PHOTO+study:FORCE+study:PHOTO+(bday~study+FORCE+PHOTO+study:FORCE+study:PHOTO|GEN.SPA),data=both.dat1)
summary(both.mod.bud1.int)
both.mod.leaf1.int<-brm(lday~study+FORCE+PHOTO+study:FORCE+study:PHOTO+(bday~study+FORCE+PHOTO+study:FORCE+study:PHOTO|GEN.SPA),data=both.dat1)
summary(both.mod.leaf1.int)
both.mod.bud2.int<-brm(bday~study+FORCE+PHOTO+study:FORCE+study:PHOTO+(bday~study+FORCE+PHOTO+study:FORCE+study:PHOTO|GEN.SPA),data=both.dat2)
summary(both.mod.bud2.int)
both.mod.leaf2.int<-brm(lday~study+FORCE+PHOTO+study:FORCE+study:PHOTO+(bday~study+FORCE+PHOTO+study:FORCE+study:PHOTO|GEN.SPA),data=both.dat2)
summary(both.mod.leaf2.int)
both.dat.sameforce2<-both.dat2 %>% filter(warm %in% c(20,18))# This make a data sheet where the average forcing in both experiments was 15 C (DB low, DF high)
both.dat.sameforce1<-both.dat1 %>% filter(warm %in% c(20,18))
photo.only.bb1<-brm(bday~study*PHOTO+(study*PHOTO|GEN.SPA),data=both.dat.sameforce1,iter=3000,warmup=2000)
summary(photo.only.bb)
summary(photo.only.bb1)
photo.only.leaf1<-brm(lday~study*PHOTO+(study*PHOTO|GEN.SPA),data=both.dat.sameforce1,iter=3000,warmup=2000)
summary(photo.only.leaf1)
photo.only.bb2<-brm(bday~study*PHOTO+(study*PHOTO|GEN.SPA),data=both.dat.sameforce2,iter=3000,warmup=2000)
summary(photo.only.bb2)
photo.only.leaf2<-brm(lday~study*PHOTO+(study*PHOTO|GEN.SPA),data=both.dat.sameforce2,iter=3000,warmup=2000)
summary(photo.only.leaf2)
photo.only.bb1.noint<-brm(bday~study*PHOTO+(1|GEN.SPA),data=both.dat.sameforce1,iter=3000,warmup=2000)
summary(photo.only.bb1.noint)
both.dat1$warm.cent<-both.dat$warm-mean(both.dat1$warm)
both.dat1$warm.cent<-both.dat1$warm-mean(both.dat1$warm)
both.dat1$photo.cent<-both.dat1$photo-mean(both.dat1$photo)
both.dat1$warm.cent<-both.dat1$warm-mean(both.dat1$warm)
both.dat1$photo.cent<-both.dat1$photo-mean(both.dat1$photo)
both.dat2$warm.cent<-both.dat2$warm-mean(both.dat2$warm)
both.dat2$photo.cent<-both.dat2$photo-mean(both.dat2$photo)
####try it with continuous preidctors
both.mod.bud1.cont<-brm(bday~study+warm.cent+photo.cent+study:warm.cent+study:photo.cent+(1|GEN.SPA),data=both.dat1)
summary(both.mod.bud1.cont)
####try it with continuous preidctors
both.mod.bud1.cont<-brm(bday~study+warm.cent+photo.cent+study:warm.cent+study:photo.cent+(study+warm.cent+photo.cent+study:warm.cent+study:photo.cent|GEN.SPA),data=both.dat1)
summary(both.mod.bud1.cont)
coef(photo.only.bb1)
coef(photo.only.bb2)
save.image("periodicity_mods.RData")
###fake data for germination mdodels
rm(list=ls())
options(stringsAsFactors = FALSE)
graphics.off()
library(drc)
library(tidyverse)
library(MCMCglmm)
library(shinystan)
library(rstan)
library(rstanarm)
library(bayesplot)
options(mc.cores = parallel::detectCores())
setwd("~/Documents/git/timetogerminate/germination_trials")
##use lognoral to simulate the data
set.seed(613613)
d<-read.csv("input/cumulative_data.csv")
View(d)
d<-read.csv("input/daily_dat_nointerval.csv")
View(d)
crpto<-filter(d,Taxa=="Cryptotaenia canadensis")
